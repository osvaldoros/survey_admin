//>>built
define("dojo/io/iframe",["../main","require"],function(b,n){b.getObject("io",!0,b);b.io.iframe={create:function(a,d,c){if(window[a])return window[a];if(window.frames[a])return window.frames[a];c||(b.config.useXDomain&&!b.config.dojoBlankHtmlUrl&&console.warn("dojo.io.iframe.create: When using cross-domain Dojo builds, please save dojo/resources/blank.html to your domain and set djConfig.dojoBlankHtmlUrl to the path on your domain to blank.html"),c=b.config.dojoBlankHtmlUrl||n.toUrl("../resources/blank.html"));
d=b.place('<iframe id="'+a+'" name="'+a+'" src="'+c+'" onload="'+d+'" style="position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden">',b.body());return window[a]=d},setSrc:function(a,d,c){try{if(c){var e;(e=b.isIE||b.isWebKit?a.contentWindow.document:a.contentWindow)?e.location.replace(d):a.location=d}else b.isWebKit?a.location=d:frames[a.name].location=d}catch(g){console.log("dojo.io.iframe.setSrc: ",g)}},doc:function(a){return a.contentDocument||a.name&&a.document&&
b.doc.getElementsByTagName("iframe")[a.name].contentWindow&&b.doc.getElementsByTagName("iframe")[a.name].contentWindow.document||a.name&&b.doc.frames[a.name]&&b.doc.frames[a.name].document||null},send:function(a){if(!this._frame)this._frame=this.create(this._iframeName,b._scopeName+".io.iframe._iframeOnload();");a=b._ioSetArgs(a,function(a){a.canceled=!0;a.ioArgs._callNext()},function(a){var c=null;try{var e=a.ioArgs,g=b.io.iframe,i=g.doc(g._frame),f=e.handleAs,c=i;if(f!="html")if(f=="xml"){if(b.isIE<
9||b.isIE&&b.isQuirks){b.query("a",g._frame.contentWindow.document.documentElement).orphan();var h=g._frame.contentWindow.document.documentElement.innerText,h=h.replace(/>\s+</g,"><"),h=b.trim(h),c=b._contentHandlers.xml({responseText:h})}}else c=i.getElementsByTagName("textarea")[0].value,f=="json"?c=b.fromJson(c):f=="javascript"&&(c=b.eval(c))}catch(j){c=j}finally{e._callNext()}return c},function(a,b){b.ioArgs._hasError=!0;b.ioArgs._callNext();return a});a.ioArgs._callNext=function(){if(!this._calledNext)this._calledNext=
!0,b.io.iframe._currentDfd=null,b.io.iframe._fireNextRequest()};this._dfdQueue.push(a);this._fireNextRequest();b._ioWatch(a,function(a){return!a.ioArgs._hasError},function(a){return!!a.ioArgs._finished},function(a){a.ioArgs._finished?a.callback(a):a.errback(Error("Invalid dojo.io.iframe request state"))});return a},_currentDfd:null,_dfdQueue:[],_iframeName:b._scopeName+"IoIframe",_fireNextRequest:function(){try{if(!(this._currentDfd||this._dfdQueue.length==0)){do var a=this._currentDfd=this._dfdQueue.shift();
while(a&&a.canceled&&this._dfdQueue.length);if(!a||a.canceled)this._currentDfd=null;else{var d=a.ioArgs,c=d.args;d._contentToClean=[];var e=b.byId(c.form),g=c.content||{};if(e){if(g){var i=function(a,c){b.create("input",{type:"hidden",name:a,value:c},e);d._contentToClean.push(a)},f;for(f in g){var h=g[f];if(b.isArray(h)&&h.length>1){var j;for(j=0;j<h.length;j++)i(f,h[j])}else e[f]?e[f].value=h:i(f,h)}}var k=e.getAttributeNode("action"),l=e.getAttributeNode("method"),m=e.getAttributeNode("target");
if(c.url)d._originalAction=k?k.value:null,k?k.value=c.url:e.setAttribute("action",c.url);if(!l||!l.value)l?l.value=c.method?c.method:"post":e.setAttribute("method",c.method?c.method:"post");d._originalTarget=m?m.value:null;m?m.value=this._iframeName:e.setAttribute("target",this._iframeName);e.target=this._iframeName;b._ioNotifyStart(a);e.submit()}else i=c.url+(c.url.indexOf("?")>-1?"&":"?")+d.query,b._ioNotifyStart(a),this.setSrc(this._frame,i,!0)}}}catch(n){a.errback(n)}},_iframeOnload:function(){var a=
this._currentDfd;if(a){var a=a.ioArgs,d=b.byId(a.args.form);if(d){for(var c=a._contentToClean,e=0;e<c.length;e++)for(var g=c[e],i=0;i<d.childNodes.length;i++){var f=d.childNodes[i];if(f.name==g){b.destroy(f);break}}a._originalAction&&d.setAttribute("action",a._originalAction);if(a._originalTarget)d.setAttribute("target",a._originalTarget),d.target=a._originalTarget}a._finished=!0}else this._fireNextRequest()}};return b.io.iframe});