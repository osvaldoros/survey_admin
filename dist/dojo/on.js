//>>built
define("dojo/on",["./has!dom-addeventlistener?:./aspect","./_base/kernel","./has"],function(q,r,g){function s(a,c,b,d,h){if(d=c.match(/(.*):(.*)/))return c=d[2],d=d[1],e.selector(d,c).call(h,a,b);g("touch")&&(t.test(c)&&(b=j(b)),!g("event-orientationchange")&&c=="orientationchange"&&(c="resize",a=window,b=j(b)));if(a.addEventListener){var f=c in i;a.addEventListener(f?i[c]:c,b,f);return{remove:function(){a.removeEventListener(c,b,f)}}}c="on"+c;if(k&&a.attachEvent)return k(a,c,b);throw Error("Target must be an event emitter");
}function u(){this.cancelable=!1}function v(){this.bubbles=!1}var l=window.ScriptEngineMajorVersion;g.add("jscript",l&&l()+ScriptEngineMinorVersion()/10);g.add("event-orientationchange",g("touch")&&!g("android"));var e=function(a,c,b,d){if(a.on)return a.on(c,b);return e.parse(a,c,b,s,d,this)};e.pausable=function(a,c,b,d){var h,a=e(a,c,function(){if(!h)return b.apply(this,arguments)},d);a.pause=function(){h=!0};a.resume=function(){h=!1};return a};e.once=function(a,c,b){var d=e(a,c,function(){d.remove();
return b.apply(this,arguments)});return d};e.parse=function(a,c,b,d,h,f){if(c.call)return c.call(f,a,b);if(c.indexOf(",")>-1){for(var c=c.split(/\s*,\s*/),e=[],g=0,m;m=c[g++];)e.push(d(a,m,b,h,f));e.remove=function(){for(var a=0;a<e.length;a++)e[a].remove()};return e}return d(a,c,b,h,f)};var t=/^touch/;e.selector=function(a,c,b){return function(d,h){var f=this,g=c.bubble;g?c=g:b!==!1&&(b=!0);return e(d,c,function(c){var e=c.target;for(f=f&&f.matches?f:r.query;!f.matches(e,a,d);)if(e==d||!b||!(e=e.parentNode))return;
return h.call(e,c)})}};var w=[].slice,x=e.emit=function(a,c,b){var d=w.call(arguments,2),e="on"+c;if("parentNode"in a){var f=d[0]={},g;for(g in b)f[g]=b[g];f.preventDefault=u;f.stopPropagation=v;f.target=a;f.type=c;b=f}do a[e]&&a[e].apply(a,d);while(b&&b.bubbles&&(a=a.parentNode));return b&&b.cancelable&&b},i={};if(g("dom-addeventlistener")){i={focusin:"focus",focusout:"blur"};if(g("opera"))i.keydown="keypress";e.emit=function(a,c,b){if(a.dispatchEvent&&document.createEvent){var d=document.createEvent("HTMLEvents");
d.initEvent(c,!!b.bubbles,!!b.cancelable);for(var g in b)g in d||(d[g]=b[g]);return a.dispatchEvent(d)&&d}return x.apply(e,arguments)}}else{e._fixEvent=function(a,c){if(!a)a=(c&&(c.ownerDocument||c.document||c).parentWindow||window).event;if(!a)return a;if(!a.target){a.target=a.srcElement;a.currentTarget=c||a.srcElement;if(a.type=="mouseover")a.relatedTarget=a.fromElement;if(a.type=="mouseout")a.relatedTarget=a.toElement;if(!a.stopPropagation)a.stopPropagation=y,a.preventDefault=z;switch(a.type){case "keypress":var b=
"charCode"in a?a.charCode:a.keyCode;b==10?(b=0,a.keyCode=13):b==13||b==27?b=0:b==3&&(b=99);a.charCode=b;b=a;b.keyChar=b.charCode?String.fromCharCode(b.charCode):"";b.charOrCode=b.keyChar||b.keyCode}}return a};var n=function(a){this.handle=a};n.prototype.remove=function(){delete _dojoIEListeners_[this.handle]};var A=function(a){return function(c){c=e._fixEvent(c,this);return a.call(this,c)}},k=function(a,c,b){b=A(b);if(((a.ownerDocument?a.ownerDocument.parentWindow:a.parentWindow||a.window||window)!=
top||g("jscript")<5.8)&&!g("config-_allow_leaks")){typeof _dojoIEListeners_=="undefined"&&(_dojoIEListeners_=[]);var d=a[c];if(!d||!d.listeners){var e=d;a[c]=d=Function("event","var callee = arguments.callee; for(var i = 0; i<callee.listeners.length; i++){var listener = _dojoIEListeners_[callee.listeners[i]]; if(listener){listener.call(this,event);}}");d.listeners=[];d.global=this;e&&d.listeners.push(_dojoIEListeners_.push(e)-1)}d.listeners.push(a=d.global._dojoIEListeners_.push(b)-1);return new n(a)}return q.after(a,
c,b,!0)},y=function(){this.cancelBubble=!0},z=e._preventDefault=function(){this.bubbledKeyCode=this.keyCode;if(this.ctrlKey)try{this.keyCode=0}catch(a){}this.returnValue=!1}}if(g("touch"))var o=function(){},p=window.orientation,j=function(a){return function(c){var b=c.corrected;if(!b){var d=c.type;try{delete c.type}catch(e){}c.type?(o.prototype=c,b=new o,b.preventDefault=function(){c.preventDefault()},b.stopPropagation=function(){c.stopPropagation()}):(b=c,b.type=d);c.corrected=b;if(d=="resize"){if(p==
window.orientation)return null;p=window.orientation;b.type="orientationchange";return a.call(this,b)}if(!("rotation"in b))b.rotation=0,b.scale=1;var d=b.changedTouches[0],f;for(f in d)delete b[f],b[f]=d[f]}return a.call(this,b)}};return e});