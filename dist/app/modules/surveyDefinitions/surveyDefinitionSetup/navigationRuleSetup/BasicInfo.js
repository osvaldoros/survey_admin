//>>built
require({cache:{"url:app/modules/surveyDefinitions/surveyDefinitionSetup/navigationRuleSetup/templates/BasicInfo.html":'<div class="moduleContainer" class="centerPanel" data-dojo-type="dijit.layout.ContentPane" data-dojo-props="region: \'center\'">\n\t\n\t<form dojoType="app.form.Manager" data-dojo-attach-point="navigationRuleBasicInfoForm" method="post">\n\t\t<table cellpadding="0" cellspacing="2" style="width: 100%;">\n\t\t\t<tr>\n\t\t\t\t<td  label="true">From question: </td>\n\t\t\t\t<td><select data-dojo-attach-point="from_question_idBox" name="from_question_id" store="{config:{url:\'QUESTION\'}}" observer="recordChange, refreshUI" dojoType="app.form.FilteringSelect" maxHeight="200"></select></td>\n\t\t\t\t<td></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td  label="true">Evaluate question: </td>\n\t\t\t\t<td><select data-dojo-attach-point="question_to_evaluate_idBox" name="question_to_evaluate_id" store="{config:{url:\'QUESTION\'}}" observer="recordChange, refreshUI" dojoType="app.form.FilteringSelect" maxHeight="200"></select></td>\n\t\t\t\t<td></td>\n\t\t\t</tr>\n\t\t\t<\!--\n\t\t\t<tr>\n\t\t\t\t<td  label="true">If response equals: </td>\n\t\t\t\t<td><select data-dojo-attach-point="response_value_conditionBox" name="response_value_condition" observer="recordChange, refreshUI" dojoType="app.form.FilteringSelect" maxHeight="200"></select></td>\n\t\t\t\t<td></td>\n\t\t\t</tr>\n\t\t\t--\>\n\t\t\t<tr>\n\t\t\t\t<td label="true">Jump to question: </td>\n\t\t\t\t<td><select data-dojo-attach-point="to_question_idBox" name="to_question_id" store="{config:{url:\'QUESTION\'}}" observer="recordChange, refreshUI" dojoType="app.form.FilteringSelect" maxHeight="200"></select></td>\n\t\t\t\t<td></td>\n\t\t\t</tr>\n\t\t</table>\n\n\t\t<\!-- Find answers --\>\n\t\t<div class="floatLeft" style="margin-top:20px; margin-bottom:10px; margin-left:33px; clear:both;">\n\t\t\t<h3 class="floatLeft" >Available responses:</h3>\n\t\t\t<div class="edgePanel" style="clear: both; margin-top:30px;">\n\t\t\t\t<table data-dojo-type="dgrid.Grid" data-dojo-attach-point="answersGrid" style="height: 250px; width: 295px;">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th data-dgrid-column="{field:\'name\', sortable:true}">Response</th>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t\t<div class="centerPanel, gridButtons" data-dojo-type="dijit.layout.ContentPane" data-dojo-props="region: \'center\'">\n\t\t\t\t\t<div class="floatRight" data-dojo-type="dijit.form.Button" data-dojo-attach-point="addToResponsesBtn">\n\t\t\t    \t    Add To Conditions\n\t\t\t    \t</div>\n\t\t\t    </div>\n\t\t\t</div>\n\t\t</div>\n\t\t\n\t\t<\!-- Rule answers --\>\n\t\t<div class="floatRight" style="margin-top:20px; margin-bottom:10px; margin-right:96px;">\t\n\t\t\t<h3 class="floatLeft" >If matches one of:</h3>\t\t\n\t\t\t<div class="edgePanel" style="clear: both; margin-top:30px;">\n\t\t\t\t<table data-dojo-type="dgrid.Grid" data-dojo-attach-point="responseValueConditionGrid" style="height: 250px; width: 295px;">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th data-dgrid-column="{field:\'name\', sortable:true}">Response</th>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t\t<div class="centerPanel, gridButtons" data-dojo-type="dijit.layout.ContentPane" data-dojo-props="region: \'center\'">\n\t\t\t\t\t<div class="floatLeft" data-dojo-type="dijit.form.Button" data-dojo-attach-point="removeFromResponsesBtn">\n\t\t\t    \t    Remove from Conditions\n\t\t\t    \t</div>\n\t\t\t    </div>\n\t\t\t</div>\n\t\t</div>\n\t</form>\n</div>'}});
define("app/modules/surveyDefinitions/surveyDefinitionSetup/navigationRuleSetup/BasicInfo",["dojo/_base/declare","dojo/on","dojo/topic","dijit/_WidgetBase","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","app/mixins/StatefulModule","dojo/text!./templates/BasicInfo.html","dojo/_base/lang","dojo/_base/Deferred","dijit/registry","dijit/Dialog","dgrid/GridFromHtml","dojo/store/Memory","dojo/store/Observable","dojo/store/Cache","app/store/JsonRest","dgrid/Selection","dojo/parser","dojo/query",
"dijit/form/Button","dojox/validate","dojox/validate/web","app/form/Manager","app/mixins/FormManager","dijit/form/Textarea","dijit/form/TextBox","dijit/form/TimeTextBox","dijit/form/DateTextBox","dijit/form/Select","dijit/form/ComboBox","app/form/FilteringSelect","dijit/form/CheckBox","dijit/form/RadioButton","dijit/form/ValidationTextBox","dojox/form/CheckedMultiSelect","dojox/form/BusyButton","app/store/UIStores","app/utils/ChangeTracker","app/mixins/GridManager"],function(f,r,h,i,j,k,g,l,c,s,t,
u,v,w,x,y,z,A,B,C,D,E,F,G,m,H,I,J,K,L,M,N,O,P,Q,R,S,n,o,p){return f("app.modules.surveyDefinitions.surveyDefinitionSetup.navigationRuleSetup.BasicInfo",[i,j,k,g,m],{widgetsInTemplate:!0,templateString:l,uiStores:n.getInstance(),changeTracker:o.getInstance(),startup:function(){this.inherited(arguments);var a=f([g,p]);this.answersGridMgr=new a;this.responseValueConditionGridMgr=new a;this.answersGrid=this.getWidget("answersGrid");this.responseValueConditionGrid=this.getWidget("responseValueConditionGrid");
this.addToResponsesBtn=this.getWidget("addToResponsesBtn");this.removeFromResponsesBtn=this.getWidget("removeFromResponsesBtn");this.from_question_idBox=this.getWidget("from_question_idBox");this.question_to_evaluate_idBox=this.getWidget("question_to_evaluate_idBox");this.to_question_idBox=this.getWidget("to_question_idBox");this.navigationRuleBasicInfoForm=this.getWidget("navigationRuleBasicInfoForm");this.navigationRuleBasicInfoForm.set("storeURL",__.urls.NAVIGATION_RULE);this.navigationRuleBasicInfoForm.set("refreshUI",
c.hitch(this,"refreshFormUI"));this.answersGridMgr.configureGrid({grid:this.answersGrid,editButton:this.addToResponsesBtn,runDefaultEdit:!1,store:__.urls.RESPONSE_CODE,base_query:c.hitch(this,"responseCodeBaseQuery"),editEntityCallBack:c.hitch(this,"responseSelected")});this.responseValueConditionGridMgr.configureGrid({grid:this.responseValueConditionGrid,deleteButton:this.removeFromResponsesBtn,runDefaultEdit:!1,store:[],arrayStoreDataChangeCallBack:c.hitch(this,"responsesChange")});this.configureForm(this.navigationRuleBasicInfoForm)},
onActivate:function(){this.inherited(arguments);if(typeof this.eventHandlers=="undefined")this.eventHandlers=[];var a=this.getUpdatingEntity();this.viewInForm(a,this.navigationRuleBasicInfoForm);this.questionsLoadedHandler=h.subscribe(__.urls.QUESTION+"-loadedComplete",c.hitch(this,"questionsLoaded"));if(typeof a=="object"&&a!=null&&a.hasOwnProperty("response_value_condition")&&a.response_value_condition!=null){for(var b=a.response_value_condition.split(","),q=a.response_value_condition_display.split(" or "),
e=[],d=b.length-1;d>=0;d--)e.push({id:b[d],name:q[d]});this.responseValueConditionGridMgr.setStore({store:e});a.hasOwnProperty("question_to_evaluate_id")&&a.question_to_evaluate_id!=null?this.question_to_evaluate_idBox.store.query({}):this.from_question_idBox.store.query({})}else this.from_question_idBox.store.query({});this.answersGridMgr.activate();this.responseValueConditionGridMgr.activate()},questionsLoaded:function(){this.answersGridMgr.refresh()},responseSelected:function(a){this.responseValueConditionGridMgr.__store.put(c.clone(a))},
responsesChange:function(){for(var a=this.responseValueConditionGridMgr.__store.data,b=[],c=[],e=a.length-1;e>=0;e--){var d=a[e];typeof d=="object"&&d!=null&&(b.push(d.id),c.push(d.name))}a=b.join(",");c=c.join(" or ");this.changeTracker.setChange(__.urls.NAVIGATION_RULE,"response_value_condition",a);this.changeTracker.setChange(__.urls.NAVIGATION_RULE,"response_value_condition_display",c)},refreshFormUI:function(a,b){switch(b){case "question_to_evaluate_id":this.answersGridMgr.refresh(),this.responseValueConditionGridMgr.setStore({store:[]}),
this.responsesChange()}},prepareForSave:function(){var a=this.changeTracker.getChangesObject(__.urls.NAVIGATION_RULE),b;for(b in a){if(b=="from_question_id")a.from_question_display=this.from_question_idBox.item.name;if(b=="question_to_evaluate_id")a.question_to_evaluate_display=this.question_to_evaluate_idBox.item.name;if(b=="to_question_id")a.to_question_display=this.to_question_idBox.item.name}return!0},responseCodeBaseQuery:function(){this.questionsLoadedHandler&&this.questionsLoadedHandler.remove();
var a=this.question_to_evaluate_idBox.item;if(typeof a=="object"&&a!=null)return{response_type_id:a.response_type_id};else if(a=this.from_question_idBox.item,typeof a=="object"&&a!=null)return{response_type_id:a.response_type_id};return!1},onDeactivate:function(){for(var a=0;a<this.eventHandlers.length;a++){var b=this.eventHandlers[a];typeof b!="undefined"&&b.remove()}this.questionsLoadedHandler&&this.questionsLoadedHandler.remove();this.answersGridMgr.deactivate();this.responseValueConditionGridMgr.deactivate();
this.eventHandlers=[];this.inherited(arguments)}})});