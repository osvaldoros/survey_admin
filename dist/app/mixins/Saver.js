//>>built
define("app/mixins/Saver",["dojo/_base/declare","dojo/dom","dojo/on","dojo/_base/lang","dojo/topic","app/utils/ChangeTracker","app/mixins/CallBacks"],function(d,h,e,b,c,f,g){return d([g],{updatingEntity:null,changeTracker:f.getInstance(),entityInjected:!1,configureSaver:function(a){this.__saveButton=a.saveButton;this.__statusLabel=a.statusLabel;this.__storeURL=typeof a.storeURL=="string"?a.storeURL:"NO_STORE_"+this.id},getStoreURL:function(){return this.__storeURL},setUpdatingEntity:function(a,b){this.updatingEntity=
a;this.entityInjected=b},getUpdatingEntity:function(){return this.updatingEntity},onActivate:function(){if(typeof this.eventHandlers=="undefined")this.eventHandlers=[];this.eventHandlers.push(c.subscribe(this.__storeURL+"-modified",b.hitch(this,"__entityModified")));this.eventHandlers.push(c.subscribe(this.__storeURL+"-created",b.hitch(this,"__entityCreated")));this.eventHandlers.push(c.subscribe(this.__storeURL+"-cleared",b.hitch(this,"__entityCleared")));this.eventHandlers.push(c.subscribe(this.__storeURL+
"-saved",b.hitch(this,"__entitySaved")));typeof this.__saveButton!="undefined"&&this.__saveButton!=null&&this.eventHandlers.push(e(this.__saveButton,"click",b.hitch(this,"onSaveClicked")));this.refreshButtons();this.inherited(arguments)},shouldCommitOnSave:function(){if(typeof this.__storeURL=="string")return this.__storeURL.indexOf("NO_STORE")==-1;return!1},onSaveClicked:function(){this.prepareForSave()!==!1&&this.save()},save:function(){typeof this.__saveButton!="undefined"&&this.__saveButton!=
null&&this.__saveButton.set("disabled",!0);this._pendingGoNextStep=!1;this.changeTracker.commitChanges(this.__storeURL,this.updatingEntity)},__entityCreated:function(a){this.runCallBack("entityCreated",a);this.entityCreated(a);this.__entitySaved(a)},__entityModified:function(a){this.runCallBack("entityModified",a);this.entityModified(a);this.refreshButtons()},__entityCleared:function(a){this.runCallBack("entityCleared",a);this.refreshButtons()},__entitySaved:function(a){this.runCallBack("entitySaved",
a);this.setUpdatingEntity(a);this.refreshButtons()},refreshButtons:function(){typeof this.__saveButton!="undefined"&&this.__saveButton!=null&&(this.changeTracker.isModified(this.__storeURL)?this.__saveButton.set("disabled",!1):this.__saveButton.set("disabled",!0));if(typeof this.__statusLabel!="undefined"&&this.__statusLabel!=null)this.__statusLabel.style.display=this.changeTracker.isModified(this.__storeURL)?"":"none"},prepareForSave:function(){return!0},requireHideConfirmation:function(){return this.changeTracker.isModified(this.__storeURL)},
entityCreated:function(){},entityModified:function(){}})});