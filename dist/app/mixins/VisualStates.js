//>>built
define("app/mixins/VisualStates",["dojo/_base/declare","dojo/query","dojo/_base/array","app/utils/DisplayManager","app/utils/HashManager"],function(g,c,h,m,n){return g([],{displayManager:m.getInstance(),hashManager:n.getInstance(),_currentState:"",setCurrentState:function(b){var a=this._currentState;this._currentState=b;(b=a!=this._currentState)&&typeof this.deactivateChildren!="undefined"&&this.deactivateChildren(this.getStateActivatableComponents(a,!0));this.refreshState();a=this.getStateActivatableComponents(null,
!0);b&&typeof this.activateChildren!="undefined"&&this.activateChildren(a);typeof this.driveChildrenState!="undefined"&&this.driveChildrenState(a)},getCurrentState:function(){return this._currentState},getStateComponents:function(b,a){var d=typeof b!="undefined"&&b!=null?b:this._currentState;return a?d!=""?c("#"+this.domNode.id+" > ."+d):[]:d!=""?c("."+d,this.domNode):[]},getStateActivatableComponents:function(b){if(typeof this.domNode=="undefined"||this.domNode==null)return[];var a;this instanceof
dijit.layout.ContentPane&&this.getChildren().length==1?(a=this.getChildren()[0],a=c("#"+a.domNode.id+" > .activatable")):a=c("#"+this.domNode.id+" > .activatable");for(var d=c("#"+this.domNode.id+" > .includeInStates"),i=c("#"+this.domNode.id+" > .excludeFromStates"),e=this.getStateComponents(b,!0),b=this.displayManager.getMatchedElements(e,d),i=this.displayManager.getMatchedElements(e,i),e=[],j=a.length-1;j>=0;j--){var f=a[j],k=!1,k=h.indexOf(d,f)!=-1,g=h.indexOf(b,f)!=-1,l=h.indexOf(i,f)!=-1;(k=
!k&&!l||g&&!l)&&e.push(f)}return e},refreshState:function(b){var a=this.getStateComponents();typeof b=="undefined"&&(b=!1);this.displayManager.includeElements(a,c(".includeInStates",this.domNode));this.displayManager.excludeElements(a,c(".excludeFromStates",this.domNode));typeof this.refreshPermissions!="undefined"&&this.refreshPermissions();this.displayManager.valid||this.displayManager.validate();if(this.topModule)b?this.hashManager.getLastModuleURL(this.hashParams.hashPieces[0])!=null?this.hashManager.setHash(this.hashManager.getLastModuleURL(this.hashParams.hashPieces[0])):
this.hashManager.setHash(this.hashParams.hashPieces[0]+"/"+this._currentState):this.hashManager.setState(this._currentState);else if(typeof this.stateHashFunction!="undefined")this.hashManager[this.stateHashFunction](this._currentState)}})});