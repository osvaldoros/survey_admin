//>>built
define("app/uicomponents/InheritedEntriesGrid",["dojo/_base/declare","dojo/on","dojo/_base/lang","./NestedEntriesGrid","app/utils/ArrayUtils"],function(g,j,d,h,i){return g("app.uicomponents.InheritedEntriesGrid",[h],{entrySelectionChange:function(a){a.inherited==!0?(this.editEntryBtn.set("label","Override Entry"),this.removeEntryBtn.set("disabled",!0)):(this.editEntryBtn.set("label","Edit Entry"),this.removeEntryBtn.set("disabled",!1))},loadEntriesFromParentEntity:function(){this.parentEntity=this.getUpdatingEntity();
this.entriesArray=typeof this.parentEntity!="undefined"&&this.parentEntity!=null&&d.isArray(this.parentEntity[this.entriesProperty])?d.clone(this.parentEntity[this.entriesProperty]):[];this.inheritedEntriesArray=typeof this.parentEntity!="undefined"&&this.parentEntity!=null?d.clone(this.parentEntity["inherited_"+this.entriesProperty]):[];this.setupDialog.set("entries",this.addArrayToGrid(),!0)},addArrayToGrid:function(){return this.mergeArraysIntoGrid(this.entriesArray,this.inheritedEntriesArray)},
mergeArraysIntoGrid:function(a,f){this.entryMap={};var e=[];if(typeof this.parentEntity=="object"&&this.parentEntity!=null){if(d.isArray(a))for(var c=0;c<a.length;c++){var b=a[c];this.addEntryToMap(b)?(b.inherited=!1,b.schedule={name:this.parentEntity.name,id:this.parentEntity.id},e.push(b)):(console.log("duplicate entry"),console.log(b))}if(d.isArray(f))for(c=0;c<f.length;c++)b=f[c],this.addEntryToMap(b)?(b.inherited=!0,e.push(b)):(console.log("duplicate inherited entry"),console.log(b))}i.addIds(e);
this.entryGridMgr.setStore({store:e});this.entryGrid.refresh();return e},onEntryEntitySaved:function(a){a.__stay_open||this.setupDialog.confirmHide();a.inherited==!0||!a.hasOwnProperty("id")?(delete a.inherited,this.entriesArray.push(a)):this.entriesArray[a.id]=a;this.addArrayToGrid();this.changeTracker.setChange(this.storeURL,this.entriesProperty,this.entriesArray)}})});