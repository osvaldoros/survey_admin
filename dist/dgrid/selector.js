//>>built
define("dgrid/selector",["dojo/_base/kernel","dojo/on","dojo/aspect","dojo/_base/sniff","put-selector/put"],function(n,r,o,s,k){return function(d,h){function l(c){return function(b){for(var e=b.rows,f=e.length,b=0;b<f;b++){var g=a.cell(e[b],d.id).element;if(g&&(g=(g.contents||g).input,!g.disabled))g.checked=c}if(i.type=="checkbox"){e=a.selection;f=!1;for(b in e)if(e[b]!=a.allSelected){f=!0;break}i.indeterminate=f;i.checked=a.allSelected}}}function p(c){if(c.type=="click"||c.keyCode==32||c.keyCode==
0){var b=a.row(c),e=a._lastSelected&&a.row(a._lastSelected);if(h=="radio"){if(!e||e.id!=b.id)a.clearSelection(),a.select(b,null,!0),a._lastSelected=b.element}else b?(c.shiftKey?l(!0)({rows:[b]}):e=null,e=c.shiftKey?e:null,a.select(e||b,b,e?void 0:null),a._lastSelected=b.element):(k(this,(a.allSelected?"!":".")+"dgrid-select-all"),a[a.allSelected?"clearSelection":"selectAll"]())}}function m(){a._hasSelectorInputListener=!0;o.before(a,"_initSelectionEvents",function(){this.on(".dgrid-selector:click,.dgrid-selector:keydown",
p)});var c=a._handleSelect;a._handleSelect=function(a){this.cell(a).column!=d&&c.apply(this,arguments)};if(typeof d.disabled=="function"){var b=a.allowSelect;a.allowSelect=function(a){return b.call(this,a)&&!d.disabled(a.data)}}a.on("dgrid-select",l(!0));a.on("dgrid-deselect",l(!1))}if(d.type)d.selectorType=d.type,n.deprecated("columndef.type","use columndef.selectorType instead","dgrid 1.0");d.selectorType=h=h||d.selectorType||"checkbox";d.sortable=!1;var a,i,j=d.disabled,q=typeof h=="function"?
h:function(c,b,e){var f=b.parentNode;k(f&&f.contents?f:b,".dgrid-selector");c=b.input||(b.input=k(b,"input[type="+h+"]",{tabIndex:isNaN(d.tabIndex)?-1:d.tabIndex,disabled:j&&(typeof j=="function"?j(e):j),checked:c}));a._hasSelectorInputListener||m();return c};d.renderCell=function(c,b,e,f,g){if(!a)a=d.grid;b=(b=c&&a.row(c))&&a.selection[b.id];g&&(h=="radio"||typeof c=="string"||!a.allowSelectAll)?(e.appendChild(document.createTextNode(c||"")),a._hasSelectorInputListener||m()):q(b,e,c)};d.renderHeaderCell=
function(a){d.renderCell(d.label||{},null,a,null,!0);i=a.lastChild};return d}});