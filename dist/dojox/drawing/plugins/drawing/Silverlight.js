//>>built
define(["dijit","dojo","dojox"],function(h,c,f){c.provide("dojox.drawing.plugins.drawing.Silverlight");f.drawing.plugins.drawing.Silverlight=f.drawing.util.oo.declare(function(e){if(f.gfx.renderer=="silverlight")this.mouse=e.mouse,this.stencils=e.stencils,this.anchors=e.anchors,this.canvas=e.canvas,this.util=e.util,c.connect(this.stencils,"register",this,function(a){var b,d,g,e,f,i=this;(function(){b=a.container.connect("onmousedown",function(b){b.superTarget=a;i.mouse.down(b)})})();d=c.connect(a,
"setTransform",this,function(){});g=c.connect(a,"onBeforeRender",function(){});e=c.connect(a,"onRender",this,function(){});f=c.connect(a,"destroy",this,function(){c.forEach([b,d,g,e,f],c.disconnect,c)})}),c.connect(this.anchors,"onAddAnchor",this,function(a){var b=a.shape.connect("onmousedown",this.mouse,function(b){b.superTarget=a;this.down(b)}),d=c.connect(a,"disconnectMouse",this,function(){c.disconnect(b);c.disconnect(d)})}),this.mouse._down=function(a){var b=this._getXY(a),d=b.x-this.origin.x,
c=b.y-this.origin.y;d*=this.zoom;c*=this.zoom;this.origin.startx=d;this.origin.starty=c;this._lastx=d;this._lasty=c;this.drawingType=this.util.attr(a,"drawingType")||"";b=this._getId(a);d={x:d,y:c,id:b};console.log(" > > > id:",b,"drawingType:",this.drawingType,"evt:",a);this.onDown(d);this._clickTime=(new Date).getTime();this._lastClickTime&&this._clickTime-this._lastClickTime<this.doublClickSpeed&&(a=this.eventName("doubleClick"),console.warn("DOUBLE CLICK",a,d),this._broadcastEvent(a,d));this._lastClickTime=
this._clickTime},this.mouse.down=function(a){clearTimeout(this.__downInv);this.util.attr(a,"drawingType")=="surface"?this.__downInv=setTimeout(c.hitch(this,function(){this._down(a)}),500):this._down(a)},this.mouse._getXY=function(a){if(a.pageX)return{x:a.pageX,y:a.pageY,cancelBubble:!0};console.log("EVT",a);for(var b in a);console.log("EVTX",a.x);return a.x!==void 0?{x:a.x+this.origin.x,y:a.y+this.origin.y}:{x:a.pageX,y:a.pageY}},this.mouse._getId=function(a){return this.util.attr(a,"id")},this.util.attr=
function(a,b,d){if(!a)return!1;try{var e;e=a.superTarget?a.superTarget:a.superClass?a.superClass:a.target?a.target:a;if(d!==void 0)return a[b]=d;if(e.tagName){if(b=="drawingType"&&e.tagName.toLowerCase()=="object")return"surface";var f=c.attr(e,b)}return f=e[b]}catch(h){return!1}}},{})});