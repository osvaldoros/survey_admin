//>>built
define(["dijit","dojo","dojox","dojo/require!dojox/drawing/plugins/_Plugin"],function(p,a,c){a.provide("dojox.drawing.ui.dom.Pan");a.require("dojox.drawing.plugins._Plugin");a.deprecated("dojox.drawing.ui.dom.Pan","It may not even make it to the 1.4 release.",1.4);c.drawing.ui.dom.Pan=c.drawing.util.oo.declare(c.drawing.plugins._Plugin,function(b){this.domNode=b.node;var j;a.connect(this.domNode,"click",this,"onSetPan");a.connect(this.keys,"onKeyUp",this,"onKeyUp");a.connect(this.keys,"onKeyDown",
this,"onKeyDown");a.connect(this.anchors,"onAnchorUp",this,"checkBounds");a.connect(this.stencils,"register",this,"checkBounds");a.connect(this.canvas,"resize",this,"checkBounds");a.connect(this.canvas,"setZoom",this,"checkBounds");a.connect(this.canvas,"onScroll",this,function(){this._blockScroll?this._blockScroll=!1:(j&&clearTimeout(j),j=setTimeout(a.hitch(this,"checkBounds"),200))});this._mouseHandle=this.mouse.register(this)},{selected:!1,type:"dojox.drawing.ui.dom.Pan",onKeyUp:function(b){if(b.keyCode==
32)this.onSetPan(!1)},onKeyDown:function(b){if(b.keyCode==32)this.onSetPan(!0)},onSetPan:function(b){if(b===!0||b===!1)this.selected=!b;this.selected?(this.selected=!1,a.removeClass(this.domNode,"selected")):(this.selected=!0,a.addClass(this.domNode,"selected"));this.mouse.setEventMode(this.selected?"pan":"")},onPanDrag:function(b){this.canvas.domNode.parentNode.scrollTop-=b.move.y;this.canvas.domNode.parentNode.scrollLeft-=b.move.x;this.canvas.onScroll()},onStencilUp:function(){this.checkBounds()},
onStencilDrag:function(){},checkBounds:function(){var b=-Infinity,a=-Infinity,c=0,k=0,l=this.stencils.group?this.stencils.group.getTransform():{dx:0,dy:0},e=this.mouse.scrollOffset(),f=this.canvas.height,g=this.canvas.width,m=this.canvas.zoom,h=this.canvas.parentHeight,i=this.canvas.parentWidth;this.stencils.withSelected(function(d){d=d.getBounds();b=Math.max(d.x2+l.dx,b);a=Math.max(d.y2+l.dy,a)});this.stencils.withUnselected(function(d){d=d.getBounds();b=Math.max(d.x2,b);a=Math.max(d.y2,a)});a*=
m;var n=0,o=0;a>h||e.top?(f=Math.max(a,h+e.top),k=e.top,n+=this.canvas.getScrollWidth()):!k&&f>h&&(f=h);b*=m;b>i||e.left?(g=Math.max(b,i+e.left),c=e.left,o+=this.canvas.getScrollWidth()):!c&&g>i&&(g=i);g+=n*2;f+=o*2;this._blockScroll=!0;this.stencils.group&&this.stencils.group.applyTransform({dx:0,dy:0});this.stencils.withUnselected(function(a){a.transformPoints({dx:0,dy:0})});this.canvas.setDimensions(g,f,c,k)}});c.drawing.ui.dom.Pan.setup={name:"dojox.drawing.ui.dom.Pan",tooltip:"Pan Tool",iconClass:"iconPan"};
c.drawing.register(c.drawing.ui.dom.Pan.setup,"plugin")});