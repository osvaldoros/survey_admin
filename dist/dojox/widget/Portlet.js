//>>built
define(["dijit","dojo","dojox","dojo/require!dijit/TitlePane,dojo/fx"],function(g,a,h){a.experimental("dojox.widget.Portlet");a.provide("dojox.widget.Portlet");a.require("dijit.TitlePane");a.require("dojo.fx");a.declare("dojox.widget.Portlet",[g.TitlePane,g._Container],{resizeChildren:!0,closable:!0,_parents:null,_size:null,dragRestriction:!1,buildRendering:function(){this.inherited(arguments);a.style(this.domNode,"visibility","hidden")},postCreate:function(){this.inherited(arguments);a.addClass(this.domNode,
"dojoxPortlet");a.removeClass(this.arrowNode,"dijitArrowNode");a.addClass(this.arrowNode,"dojoxPortletIcon dojoxArrowDown");a.addClass(this.titleBarNode,"dojoxPortletTitle");a.addClass(this.hideNode,"dojoxPortletContentOuter");a.addClass(this.domNode,"dojoxPortlet-"+(!this.dragRestriction?"movable":"nonmovable"));var b=this;if(this.resizeChildren){this.subscribe("/dnd/drop",function(){b._updateSize()});this.subscribe("/Portlet/sizechange",function(a){b.onSizeChange(a)});this.connect(window,"onresize",
function(){b._updateSize()});var d=a.hitch(this,function(a,c){var d=g.byId(a);if(d.selectChild){var f=this.subscribe(a+"-selectChild",function(a){for(var c=b.domNode.parentNode;c;){if(c==a.domNode){b.unsubscribe(f);b._updateSize();break}c=c.parentNode}}),e=g.byId(c);d&&e&&b._parents.push({parent:d,child:e})}}),f;this._parents=[];for(var c=this.domNode.parentNode;c!=null;c=c.parentNode){var e=c.getAttribute?c.getAttribute("widgetId"):null;e&&(d(e,f),f=e)}}this.connect(this.titleBarNode,"onmousedown",
function(b){if(a.hasClass(b.target,"dojoxPortletIcon"))return a.stopEvent(b),!1;return!0});this.connect(this._wipeOut,"onEnd",function(){b._publish()});this.connect(this._wipeIn,"onEnd",function(){b._publish()});if(this.closable)this.closeIcon=this._createIcon("dojoxCloseNode","dojoxCloseNodeHover",a.hitch(this,"onClose")),a.style(this.closeIcon,"display","")},startup:function(){if(!this._started){var b=this.getChildren();this._placeSettingsWidgets();a.forEach(b,function(a){try{!a.started&&!a._started&&
a.startup()}catch(b){console.log(this.id+":"+this.declaredClass,b)}});this.inherited(arguments);a.style(this.domNode,"visibility","visible")}},_placeSettingsWidgets:function(){a.forEach(this.getChildren(),a.hitch(this,function(b){if(b.portletIconClass&&b.toggle&&!b.attr("portlet"))this._createIcon(b.portletIconClass,b.portletIconHoverClass,a.hitch(b,"toggle")),a.place(b.domNode,this.containerNode,"before"),b.attr("portlet",this),this._settingsWidget=b}))},_createIcon:function(b,d,f){var c=a.create("div",
{"class":"dojoxPortletIcon "+b,waiRole:"presentation"});a.place(c,this.arrowNode,"before");this.connect(c,"onclick",f);d&&(this.connect(c,"onmouseover",function(){a.addClass(c,d)}),this.connect(c,"onmouseout",function(){a.removeClass(c,d)}));return c},onClose:function(){a.style(this.domNode,"display","none")},onSizeChange:function(a){a!=this&&this._updateSize()},_updateSize:function(){if(this.open&&this._started&&this.resizeChildren)this._timer&&clearTimeout(this._timer),this._timer=setTimeout(a.hitch(this,
function(){for(var b={w:a.style(this.domNode,"width"),h:a.style(this.domNode,"height")},d=0;d<this._parents.length;d++){var f=this._parents[d],c=f.parent.selectedChildWidget;if(c&&c!=f.child)return}if(!this._size||!(this._size.w==b.w&&this._size.h==b.h)){this._size=b;var e=["resize","layout"];this._timer=null;b=this.getChildren();a.forEach(b,function(b){for(var c=0;c<e.length;c++)if(a.isFunction(b[e[c]])){try{b[e[c]]()}catch(d){console.log(d)}break}});this.onUpdateSize()}}),100)},onUpdateSize:function(){},
_publish:function(){a.publish("/Portlet/sizechange",[this])},_onTitleClick:function(a){a.target==this.arrowNode&&this.inherited(arguments)},addChild:function(a){this._size=null;this.inherited(arguments);this._started&&(this._placeSettingsWidgets(),this._updateSize());this._started&&!a.started&&!a._started&&a.startup()},destroyDescendants:function(a){this.inherited(arguments);this._settingsWidget&&this._settingsWidget.destroyRecursive(a)},destroy:function(){this._timer&&clearTimeout(this._timer);this.inherited(arguments)},
_setCss:function(){this.inherited(arguments);a.style(this.arrowNode,"display",this.toggleable?"":"none")}});a.declare("dojox.widget.PortletSettings",[g._Container,g.layout.ContentPane],{portletIconClass:"dojoxPortletSettingsIcon",portletIconHoverClass:"dojoxPortletSettingsIconHover",postCreate:function(){a.style(this.domNode,"display","none");a.addClass(this.domNode,"dojoxPortletSettingsContainer");a.removeClass(this.domNode,"dijitContentPane")},_setPortletAttr:function(a){this.portlet=a},toggle:function(){var b=
this.domNode;a.style(b,"display")=="none"?(a.style(b,{display:"block",height:"1px",width:"auto"}),a.fx.wipeIn({node:b}).play()):a.fx.wipeOut({node:b,onEnd:a.hitch(this,function(){a.style(b,{display:"none",height:"",width:""})})}).play()}});a.declare("dojox.widget.PortletDialogSettings",h.widget.PortletSettings,{dimensions:null,constructor:function(a){this.dimensions=a.dimensions||[300,100]},toggle:function(){if(!this.dialog)a.require("dijit.Dialog"),this.dialog=new g.Dialog({title:this.title}),a.body().appendChild(this.dialog.domNode),
this.dialog.containerNode.appendChild(this.domNode),a.style(this.dialog.domNode,{width:this.dimensions[0]+"px",height:this.dimensions[1]+"px"}),a.style(this.domNode,"display","");this.dialog.open?this.dialog.hide():this.dialog.show(this.domNode)}})});