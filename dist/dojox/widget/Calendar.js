//>>built
define(["dijit","dojo","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dijit/_Container,dijit/typematic,dojo/date,dojo/date/locale"],function(h,b,f){b.provide("dojox.widget.Calendar");b.experimental("dojox.widget.Calendar");b.require("dijit._Widget");b.require("dijit._Templated");b.require("dijit._Container");b.require("dijit.typematic");b.require("dojo.date");b.require("dojo.date.locale");b.declare("dojox.widget._CalendarBase",[h._Widget,h._Templated,h._Container],{templateString:b.cache("dojox.widget",
"Calendar/Calendar.html",'<div class="dojoxCalendar">\n    <div tabindex="0" class="dojoxCalendarContainer" style="visibility: visible;" dojoAttachPoint="container">\n\t\t<div style="display:none">\n\t\t\t<div dojoAttachPoint="previousYearLabelNode"></div>\n\t\t\t<div dojoAttachPoint="nextYearLabelNode"></div>\n\t\t\t<div dojoAttachPoint="monthLabelSpacer"></div>\n\t\t</div>\n        <div class="dojoxCalendarHeader">\n            <div>\n                <div class="dojoxCalendarDecrease" dojoAttachPoint="decrementMonth"></div>\n            </div>\n            <div class="">\n                <div class="dojoxCalendarIncrease" dojoAttachPoint="incrementMonth"></div>\n            </div>\n            <div class="dojoxCalendarTitle" dojoAttachPoint="header" dojoAttachEvent="onclick: onHeaderClick">\n            </div>\n        </div>\n        <div class="dojoxCalendarBody" dojoAttachPoint="containerNode"></div>\n        <div class="">\n            <div class="dojoxCalendarFooter" dojoAttachPoint="footer">                        \n            </div>\n        </div>\n    </div>\n</div>\n'),
_views:null,useFx:!0,widgetsInTemplate:!0,value:new Date,constraints:null,footerFormat:"medium",constructor:function(){this._views=[];this.value=new Date},postMixInProperties:function(){var a=this.constraints;if(a){var c=b.date.stamp.fromISOString;if(typeof a.min=="string")a.min=c(a.min);if(typeof a.max=="string")a.max=c(a.max)}this.value=this.parseInitialValue(this.value)},parseInitialValue:function(a){if(!a||a===-1)return new Date;else!a.getFullYear&&!isNaN(a)&&(typeof this.value=="string"&&(a=
parseInt(a)),a=this._makeDate(a));return a},_makeDate:function(a){return a},postCreate:function(){this.displayMonth=new Date(this.get("value"));if(this._isInvalidDate(this.displayMonth))this.displayMonth=new Date;var a={parent:this,_getValueAttr:b.hitch(this,function(){return new Date(this._internalValue||this.value)}),_getDisplayMonthAttr:b.hitch(this,function(){return new Date(this.displayMonth)}),_getConstraintsAttr:b.hitch(this,function(){return this.constraints}),getLang:b.hitch(this,function(){return this.lang}),
isDisabledDate:b.hitch(this,this.isDisabledDate),getClassForDate:b.hitch(this,this.getClassForDate),addFx:this.useFx?b.hitch(this,this.addFx):function(){}};b.forEach(this._views,function(c){c=new c(a,b.create("div"));this.addChild(c);var d=c.getHeader();d&&(this.header.appendChild(d),b.style(d,"display","none"));b.style(c.domNode,"visibility","hidden");b.connect(c,"onValueSelected",this,"_onDateSelected");c.set("value",this.get("value"))},this);this._views.length<2&&b.style(this.header,"cursor","auto");
this.inherited(arguments);this._children=this.getChildren();this._currentChild=0;this.footer.innerHTML="Today: "+b.date.locale.format(new Date,{formatLength:this.footerFormat,selector:"date",locale:this.lang});b.connect(this.footer,"onclick",this,"goToToday");var c=this._children[0];b.style(c.domNode,"top","0px");b.style(c.domNode,"visibility","visible");c.getHeader()&&b.style(c.getHeader(),"display","");b[c.useHeader?"removeClass":"addClass"](this.container,"no-header");c.onDisplay();var d=this,
c=function(a,b,c){h.typematic.addMouseListener(d[a],d,function(a){a>=0&&d._adjustDisplay(b,c)},0.8,500)};c("incrementMonth","month",1);c("decrementMonth","month",-1);this._updateTitleStyle()},addFx:function(){},_isInvalidDate:function(a){return!a||isNaN(a)||typeof a!="object"||a.toString()==this._invalidDate},_setValueAttr:function(a){a||(a=new Date);a.getFullYear||(a=b.date.stamp.fromISOString(a+""));if(this._isInvalidDate(a))return!1;if(!this.value||b.date.compare(a,this.value)){a=new Date(a);this.displayMonth=
new Date(a);this._internalValue=a;if(!this.isDisabledDate(a,this.lang)&&this._currentChild==0)this.value=a,this.onChange(a);this._children&&this._children.length>0&&this._children[this._currentChild].set("value",this.value);return!0}return!1},isDisabledDate:function(a){var c=this.constraints,d=b.date.compare;return c&&(c.min&&d(c.min,a,"date")>0||c.max&&d(c.max,a,"date")<0)},onValueSelected:function(){},_onDateSelected:function(a,b){this.displayMonth=a;this.set("value",a);this._transitionVert(-1)||
(!b&&b!==0&&(b=this.get("value")),this.onValueSelected(b))},onChange:function(){},onHeaderClick:function(){this._transitionVert(1)},goToToday:function(){this.set("value",new Date);this.onValueSelected(this.get("value"))},_transitionVert:function(a){var c=this._children[this._currentChild],d=this._children[this._currentChild+a];if(!d)return!1;b.style(d.domNode,"visibility","visible");var e=b.style(this.containerNode,"height");d.set("value",this.displayMonth);c.header&&b.style(c.header,"display","none");
d.header&&b.style(d.header,"display","");b.style(d.domNode,"top",e*-1+"px");b.style(d.domNode,"visibility","visible");this._currentChild+=a;a*=e;b.style(d.domNode,"top",a*-1+"px");a=b.animateProperty({node:c.domNode,properties:{top:a},onEnd:function(){b.style(c.domNode,"visibility","hidden")}});e=b.animateProperty({node:d.domNode,properties:{top:0},onEnd:function(){d.onDisplay()}});b[d.useHeader?"removeClass":"addClass"](this.container,"no-header");a.play();e.play();c.onBeforeUnDisplay();d.onBeforeDisplay();
this._updateTitleStyle();return!0},_updateTitleStyle:function(){b[this._currentChild<this._children.length-1?"addClass":"removeClass"](this.header,"navToPanel")},_slideTable:function(a,c,d){var a=a.domNode,e=a.cloneNode(!0),m=b.style(a,"width");a.parentNode.appendChild(e);b.style(a,"left",m*c+"px");d();c=b.animateProperty({node:e,properties:{left:m*c*-1},duration:500,onEnd:function(){e.parentNode.removeChild(e)}});d=b.animateProperty({node:a,properties:{left:0},duration:500});c.play();d.play()},_addView:function(a){this._views.push(a)},
getClassForDate:function(){},_adjustDisplay:function(a,b){var d=this._children[this._currentChild],e=this.displayMonth=d.adjustDate(this.displayMonth,b);this._slideTable(d,b,function(){d.set("value",e)})}});b.declare("dojox.widget._CalendarView",h._Widget,{headerClass:"",useHeader:!0,cloneClass:function(a,c,d){var e=b.query(a,this.domNode)[0];if(d){d=b.query(a,this.domNode)[0];for(a=0;a<c;a++)e.parentNode.insertBefore(e.cloneNode(!0),d)}else for(a=0;a<c;a++)e.parentNode.appendChild(e.cloneNode(!0))},
_setText:function(a,c){a.innerHTML!=c&&(b.empty(a),a.appendChild(b.doc.createTextNode(c)))},getHeader:function(){return this.header||(this.header=this.header=b.create("span",{"class":this.headerClass}))},onValueSelected:function(){},adjustDate:function(a,c){return b.date.add(a,this.datePart,c)},onDisplay:function(){},onBeforeDisplay:function(){},onBeforeUnDisplay:function(){}});b.declare("dojox.widget._CalendarDay",null,{parent:null,constructor:function(){this._addView(f.widget._CalendarDayView)}});
b.declare("dojox.widget._CalendarDayView",[f.widget._CalendarView,h._Templated],{templateString:b.cache("dojox.widget","Calendar/CalendarDay.html",'<div class="dijitCalendarDayLabels" style="left: 0px;" dojoAttachPoint="dayContainer">\n\t<div dojoAttachPoint="header">\n\t\t<div dojoAttachPoint="monthAndYearHeader">\n\t\t\t<span dojoAttachPoint="monthLabelNode" class="dojoxCalendarMonthLabelNode"></span>\n\t\t\t<span dojoAttachPoint="headerComma" class="dojoxCalendarComma">,</span>\n\t\t\t<span dojoAttachPoint="yearLabelNode" class="dojoxCalendarDayYearLabel"></span>\n\t\t</div>\n\t</div>\n\t<table cellspacing="0" cellpadding="0" border="0" style="margin: auto;">\n\t\t<thead>\n\t\t\t<tr>\n\t\t\t\t<td class="dijitCalendarDayLabelTemplate"><div class="dijitCalendarDayLabel"></div></td>\n\t\t\t</tr>\n\t\t</thead>\n\t\t<tbody dojoAttachEvent="onclick: _onDayClick">\n\t\t\t<tr class="dijitCalendarWeekTemplate">\n\t\t\t\t<td class="dojoxCalendarNextMonth dijitCalendarDateTemplate">\n\t\t\t\t\t<div class="dijitCalendarDateLabel"></div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</tbody>\n\t</table>\n</div>\n'),
datePart:"month",dayWidth:"narrow",postCreate:function(){this.cloneClass(".dijitCalendarDayLabelTemplate",6);this.cloneClass(".dijitCalendarDateTemplate",6);this.cloneClass(".dijitCalendarWeekTemplate",5);var a=b.date.locale.getNames("days",this.dayWidth,"standAlone",this.getLang()),c=b.cldr.supplemental.getFirstDayOfWeek(this.getLang());b.query(".dijitCalendarDayLabel",this.domNode).forEach(function(b,e){this._setText(b,a[(e+c)%7])},this)},onDisplay:function(){if(!this._addedFx)this._addedFx=!0,
this.addFx(".dijitCalendarDateTemplate div",this.domNode)},_onDayClick:function(a){if(typeof a.target._date!="undefined"){var c=new Date(this.get("displayMonth")),d=a.target.parentNode;(d=b.hasClass(d,"dijitCalendarPreviousMonth")?-1:b.hasClass(d,"dijitCalendarNextMonth")?1:0)&&(c=b.date.add(c,"month",d));c.setDate(a.target._date);this.isDisabledDate(c)?b.stopEvent(a):this.parent._onDateSelected(c)}},_setValueAttr:function(){this._populateDays()},_populateDays:function(){var a=new Date(this.get("displayMonth"));
a.setDate(1);var c=a.getDay(),d=b.date.getDaysInMonth(a),e=b.date.getDaysInMonth(b.date.add(a,"month",-1)),m=new Date,f=this.get("value"),n=b.cldr.supplemental.getFirstDayOfWeek(this.getLang());n>c&&(n-=7);var h=b.date.compare,j=this._lastDate,j=j==null||j.getMonth()!=a.getMonth()||j.getFullYear()!=a.getFullYear();this._lastDate=a;j?(b.query(".dijitCalendarDateTemplate",this.domNode).forEach(function(o,k){k+=n;var i=new Date(a),l,g="dijitCalendar",j=0;k<c?(l=e-c+k+1,j=-1,g+="Previous"):k>=c+d?(l=
k-c-d+1,j=1,g+="Next"):(l=k-c+1,g+="Current");j&&(i=b.date.add(i,"month",j));i.setDate(l);h(i,m,"date")||(g="dijitCalendarCurrentDate "+g);!h(i,f,"date")&&!h(i,f,"month")&&!h(i,f,"year")&&(g="dijitCalendarSelectedDate "+g);this.isDisabledDate(i,this.getLang())&&(g=" dijitCalendarDisabledDate "+g);(l=this.getClassForDate(i,this.getLang()))&&(g=l+" "+g);o.className=g+"Month dijitCalendarDateTemplate";o.dijitDateValue=i.valueOf();g=b.query(".dijitCalendarDateLabel",o)[0];this._setText(g,i.getDate());
g._date=g.parentNode._date=i.getDate()},this),this._setText(this.monthLabelNode,b.date.locale.getNames("months","wide","standAlone",this.getLang())[a.getMonth()]),this._setText(this.yearLabelNode,a.getFullYear())):b.query(".dijitCalendarDateTemplate",this.domNode).removeClass("dijitCalendarSelectedDate").filter(function(a){return a.className.indexOf("dijitCalendarCurrent")>-1&&a._date==f.getDate()}).addClass("dijitCalendarSelectedDate")}});b.declare("dojox.widget._CalendarMonthYear",null,{constructor:function(){this._addView(f.widget._CalendarMonthYearView)}});
b.declare("dojox.widget._CalendarMonthYearView",[f.widget._CalendarView,h._Templated],{templateString:b.cache("dojox.widget","Calendar/CalendarMonthYear.html",'<div class="dojoxCal-MY-labels" style="left: 0px;"\t\n\tdojoAttachPoint="myContainer" dojoAttachEvent="onclick: onClick">\n\t\t<table cellspacing="0" cellpadding="0" border="0" style="margin: auto;">\n\t\t\t\t<tbody>\n\t\t\t\t\t\t<tr class="dojoxCal-MY-G-Template">\n\t\t\t\t\t\t\t\t<td class="dojoxCal-MY-M-Template">\n\t\t\t\t\t\t\t\t\t\t<div class="dojoxCalendarMonthLabel"></div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td class="dojoxCal-MY-M-Template">\n\t\t\t\t\t\t\t\t\t\t<div class="dojoxCalendarMonthLabel"></div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td class="dojoxCal-MY-Y-Template">\n\t\t\t\t\t\t\t\t\t\t<div class="dojoxCalendarYearLabel"></div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td class="dojoxCal-MY-Y-Template">\n\t\t\t\t\t\t\t\t\t\t<div class="dojoxCalendarYearLabel"></div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t </tr>\n\t\t\t\t\t\t <tr class="dojoxCal-MY-btns">\n\t\t\t\t\t\t \t <td class="dojoxCal-MY-btns" colspan="4">\n\t\t\t\t\t\t \t\t <span class="dijitReset dijitInline dijitButtonNode ok-btn" dojoAttachEvent="onclick: onOk" dojoAttachPoint="okBtn">\n\t\t\t\t\t\t \t \t \t <button\tclass="dijitReset dijitStretch dijitButtonContents">OK</button>\n\t\t\t\t\t\t\t\t </span>\n\t\t\t\t\t\t\t\t <span class="dijitReset dijitInline dijitButtonNode cancel-btn" dojoAttachEvent="onclick: onCancel" dojoAttachPoint="cancelBtn">\n\t\t\t\t\t\t \t \t\t <button\tclass="dijitReset dijitStretch dijitButtonContents">Cancel</button>\n\t\t\t\t\t\t\t\t </span>\n\t\t\t\t\t\t \t </td>\n\t\t\t\t\t\t </tr>\n\t\t\t\t</tbody>\n\t\t</table>\n</div>\n'),
datePart:"year",displayedYears:10,useHeader:!1,postCreate:function(){this.cloneClass(".dojoxCal-MY-G-Template",5,".dojoxCal-MY-btns");this.monthContainer=this.yearContainer=this.myContainer;b.query(".dojoxCalendarYearLabel",this.myContainer).forEach(function(a,c){var d="dojoxCalendarIncrease";switch(c){case 0:d="dojoxCalendarDecrease";case 1:b.removeClass(a,"dojoxCalendarYearLabel"),b.addClass(a,d)}});this._decBtn=b.query(".dojoxCalendarDecrease",this.myContainer)[0];this._incBtn=b.query(".dojoxCalendarIncrease",
this.myContainer)[0];b.query(".dojoxCal-MY-M-Template",this.domNode).filter(function(a){return a.cellIndex==1}).addClass("dojoxCal-MY-M-last");b.connect(this,"onBeforeDisplay",b.hitch(this,function(){this._cachedDate=new Date(this.get("value").getTime());this._populateYears(this._cachedDate.getFullYear());this._populateMonths();this._updateSelectedMonth();this._updateSelectedYear()}));b.connect(this,"_populateYears",b.hitch(this,function(){this._updateSelectedYear()}));b.connect(this,"_populateMonths",
b.hitch(this,function(){this._updateSelectedMonth()}));this._cachedDate=this.get("value");this._populateYears();this._populateMonths();this.addFx(".dojoxCalendarMonthLabel,.dojoxCalendarYearLabel ",this.myContainer)},_setValueAttr:function(a){a&&a.getFullYear()&&this._populateYears(a.getFullYear())},getHeader:function(){return null},_getMonthNames:function(a){return this._monthNames=this._monthNames||b.date.locale.getNames("months",a,"standAlone",this.getLang())},_populateMonths:function(){var a=
this._getMonthNames("abbr");b.query(".dojoxCalendarMonthLabel",this.monthContainer).forEach(b.hitch(this,function(b,c){this._setText(b,a[c])}));var c=this.get("constraints");if(c){(new Date).setFullYear(this._year);var d=-1,e=12;if(c.min){var f=c.min.getFullYear();f>this._year?d=12:f==this._year&&(d=c.min.getMonth())}c.max&&(f=c.max.getFullYear(),f<this._year?e=-1:f==this._year&&(e=c.max.getMonth()));b.query(".dojoxCalendarMonthLabel",this.monthContainer).forEach(b.hitch(this,function(a,c){b[c<d||
c>e?"addClass":"removeClass"](a,"dijitCalendarDisabledDate")}))}this.getHeader()&&this._setText(this.getHeader(),this.get("value").getFullYear())},_populateYears:function(a){var c=this.get("constraints"),d=a||this.get("value").getFullYear(),e=d-Math.floor(this.displayedYears/2),a=c&&c.min?c.min.getFullYear():e-1E4,e=Math.max(a,e);this._displayedYear=d;var d=b.query(".dojoxCalendarYearLabel",this.yearContainer),f=c&&c.max?c.max.getFullYear()-e:d.length;d.forEach(b.hitch(this,function(a,c){c<=f?(this._setText(a,
e+c),b.removeClass(a,"dijitCalendarDisabledDate")):b.addClass(a,"dijitCalendarDisabledDate")}));if(this._incBtn)b[f<d.length?"addClass":"removeClass"](this._incBtn,"dijitCalendarDisabledDate");if(this._decBtn)b[a>=e?"addClass":"removeClass"](this._decBtn,"dijitCalendarDisabledDate");this.getHeader()&&this._setText(this.getHeader(),e+" - "+(e+11))},_updateSelectedYear:function(){this._year=String((this._cachedDate||this.get("value")).getFullYear());this._updateSelectedNode(".dojoxCalendarYearLabel",
b.hitch(this,function(a){return this._year!==null&&a.innerHTML==this._year}))},_updateSelectedMonth:function(){var a=(this._cachedDate||this.get("value")).getMonth();this._month=a;this._updateSelectedNode(".dojoxCalendarMonthLabel",function(b,d){return d==a})},_updateSelectedNode:function(a,c){b.query(a,this.domNode).forEach(function(a,d,f){b[c(a,d,f)?"addClass":"removeClass"](a.parentNode,"dijitCalendarSelectedDate")});var d=b.query(".dojoxCal-MY-M-Template div",this.myContainer).filter(function(a){return b.hasClass(a.parentNode,
"dijitCalendarSelectedDate")})[0];d&&(d=b.hasClass(d,"dijitCalendarDisabledDate"),b[d?"addClass":"removeClass"](this.okBtn,"dijitDisabled"))},onClick:function(a){function c(c){return b.hasClass(a.target,c)}if(c("dijitCalendarDisabledDate"))return b.stopEvent(a),!1;if(c("dojoxCalendarMonthLabel"))this._month=a.target.parentNode.cellIndex+a.target.parentNode.parentNode.rowIndex*2,this._cachedDate.setMonth(this._month),this._updateSelectedMonth();else if(c("dojoxCalendarYearLabel"))this._year=Number(a.target.innerHTML),
this._cachedDate.setYear(this._year),this._populateMonths(),this._updateSelectedYear();else return c("dojoxCalendarDecrease")?this._populateYears(this._displayedYear-10):c("dojoxCalendarIncrease")&&this._populateYears(this._displayedYear+10),!0;b.stopEvent(a);return!1},onOk:function(a){b.stopEvent(a);if(b.hasClass(this.okBtn,"dijitDisabled"))return!1;this.onValueSelected(this._cachedDate);return!1},onCancel:function(a){b.stopEvent(a);this.onValueSelected(this.get("value"));return!1}});b.declare("dojox.widget.Calendar2Pane",
[f.widget._CalendarBase,f.widget._CalendarDay,f.widget._CalendarMonthYear],{});b.declare("dojox.widget.Calendar",[f.widget._CalendarBase,f.widget._CalendarDay,f.widget._CalendarMonthYear],{});b.declare("dojox.widget.DailyCalendar",[f.widget._CalendarBase,f.widget._CalendarDay],{_makeDate:function(a){var b=new Date;b.setDate(a);return b}});b.declare("dojox.widget.MonthAndYearlyCalendar",[f.widget._CalendarBase,f.widget._CalendarMonthYear],{})});