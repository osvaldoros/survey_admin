//>>built
define(["dijit","dojo","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dojo/fx"],function(i,a){a.provide("dojox.widget.Pager");a.experimental("dojox.widget.Pager");a.require("dijit._Widget");a.require("dijit._Templated");a.require("dojo.fx");a.declare("dojox.widget.Pager",[i._Widget,i._Templated],{templateString:a.cache("dojox.widget","Pager/Pager.html",'<div dojoAttachPoint="pagerContainer" tabIndex="0" dojoAttachEvent="onkeypress: _handleKey, onfocus: _a11yStyle, onblur:_a11yStyle" class="${orientation}PagerContainer">\n    <div class="pagerContainer">\n\t\t<div dojoAttachPoint="pagerContainerStatus" class="${orientation}PagerStatus"></div>\n\t\t<div dojoAttachPoint="pagerContainerView" class="${orientation}PagerView">\n\t\t    <div dojoAttachPoint="pagerItemContainer"><ul dojoAttachPoint="pagerItems" class="pagerItems"></ul></div>\n\t\t</div>\n\t\t<div dojoAttachPoint="pagerContainerPager" class="${orientation}PagerPager">\n\t\t\t<div tabIndex="0" dojoAttachPoint="pagerNext" class="pagerIconContainer" dojoAttachEvent="onclick: _pagerNext"><img dojoAttachPoint="pagerIconNext" src="${iconNext}" alt="Next" /></div>\n\t\t\t<div tabIndex="0" dojoAttachPoint="pagerPrevious" class="pagerIconContainer" dojoAttachEvent="onclick: _pagerPrevious"><img dojoAttachPoint="pagerIconPrevious" src="${iconPrevious}" alt="Previous" /></div>\n\t\t</div>\n    </div>\n\t<div dojoAttachPoint="containerNode" style="display:none"></div>\n</div>'),
iconPage:a.moduleUrl("dojox.widget","Pager/images/pageInactive.png"),iconPageActive:a.moduleUrl("dojox.widget","Pager/images/pageActive.png"),store:null,orientation:"horizontal",statusPos:"leading",pagerPos:"center",duration:500,itemSpace:2,resizeChildren:!0,itemClass:"dojox.widget._PagerItem",itemsPage:3,postMixInProperties:function(){var c=this.orientation=="horizontal";a.mixin(this,{_totalPages:0,_currentPage:1,dirClass:"pager"+(c?"Horizontal":"Vertical"),iconNext:a.moduleUrl("dojox.widget","Pager/images/"+
(c?"h":"v")+"Next.png"),iconPrevious:a.moduleUrl("dojox.widget","Pager/images/"+(c?"h":"v")+"Previous.png")})},postCreate:function(){this.inherited(arguments);this.store.fetch({onComplete:a.hitch(this,"_init")})},_a11yStyle:function(c){a[c.type=="focus"?"addClass":"removeClass"](c.target,"pagerFocus")},_handleKey:function(c){var d=a.keys;switch(c.charCode==d.SPACE?d.SPACE:c.keyCode){case d.UP_ARROW:case d.RIGHT_ARROW:case 110:case 78:c.preventDefault();this._pagerNext();break;case d.DOWN_ARROW:case d.LEFT_ARROW:case 112:case 80:c.preventDefault();
this._pagerPrevious();break;case d.ENTER:switch(c.target){case this.pagerNext:this._pagerNext();break;case this.pagerPrevious:this._pagerPrevious()}}},_init:function(a){this.items=a;this._renderPages();this._renderStatus();this._renderPager()},_renderPages:function(){var c=this.pagerContainerView,d=this.orientation=="horizontal",b=a.style;if(d){var e=a.marginBox(this.pagerContainerPager).h,g=a.marginBox(this.pagerContainerStatus).h;if(this.pagerPos!="center")var f=e+g;else{var f=g,h=this.pagerIconNext.width,
h=b(c,"width")-2*h;b(c,{width:h+"px",marginLeft:this.pagerIconNext.width+"px",marginRight:this.pagerIconNext.width+"px"})}f=b(this.pagerContainer,"height")-f;b(this.pagerContainerView,"height",f+"px");var j=Math.floor(b(c,"width")/this.itemsPage);this.statusPos=="trailing"?(this.pagerPos!="center"&&b(c,"marginTop",e+"px"),b(c,"marginBottom",g+"px")):(b(c,"marginTop",g+"px"),this.pagerPos!="center"&&b(c,"marginTop",e+"px"))}else e=a.marginBox(this.pagerContainerPager).w,g=a.marginBox(this.pagerContainerStatus).w,
b(this.pagerContainer,"width"),this.pagerPos!="center"?f=e+g:(f=g,h=this.pagerIconNext.height,h=b(c,"height")-2*h,b(c,{height:h+"px",marginTop:this.pagerIconNext.height+"px",marginBottom:this.pagerIconNext.height+"px"})),f=b(this.pagerContainer,"width")-f,b(c,"width",f+"px"),j=Math.floor(b(c,"height")/this.itemsPage),this.statusPos=="trailing"?(this.pagerPos!="center"&&b(c,"marginLeft",e+"px"),b(c,"marginRight",g+"px")):(b(c,"marginLeft",g+"px"),this.pagerPos!="center"&&b(c,"marginRight",e+"px"));
var l=a.getObject(this.itemClass),i="padding"+(d?"Left":"Top"),n="padding"+(d?"Right":"Bottom");a.forEach(this.items,function(e,g){var f=a.create("div",{innerHTML:e.content}),f=new l({id:this.id+"-item-"+(g+1)},f);this.pagerItems.appendChild(f.domNode);var h={};h[d?"width":"height"]=j-this.itemSpace+"px";var k=d?"height":"width";h[k]=b(c,k)+"px";b(f.containerNode,h);this.resizeChildren&&f.resizeChildren();f.parseChildren();b(f.domNode,"position","absolute");g<this.itemsPage?(h=g*j,k=d?"left":"top",
b(f.domNode,d?"top":"left","0px"),b(f.domNode,k,h+"px")):(b(f.domNode,"top","-1000px"),b(f.domNode,"left","-1000px"));b(f.domNode,n,this.itemSpace/2+"px");b(f.domNode,i,this.itemSpace/2+"px")},this)},_renderPager:function(){var c=this.pagerContainerPager;this.orientation=="horizontal"?(this.statusPos!="center"&&(this.statusPos=="trailing"?a.style(c,"top","0px"):a.style(c,"bottom","0px")),a.style(this.pagerNext,"right","0px"),a.style(this.pagerPrevious,"left","0px")):(this.statusPos=="trailing"?a.style(c,
"left","0px"):a.style(c,"right","0px"),a.style(this.pagerNext,"bottom","0px"),a.style(this.pagerPrevious,"top","0px"))},_renderStatus:function(){this._totalPages=Math.ceil(this.items.length/this.itemsPage);this.iconsLoaded=this.iconHeight=this.iconWidth=0;this._iconConnects=[];for(var c=1;c<=this._totalPages;c++){var d=new Image,b=c;a.connect(d,"onclick",a.hitch(this,function(a){this._pagerSkip(a)},b));this._iconConnects[b]=a.connect(d,"onload",a.hitch(this,function(c){this.iconWidth+=d.width;this.iconHeight+=
d.height;this.iconsLoaded++;if(this._totalPages==this.iconsLoaded)if(this.orientation=="horizontal"){if(this.statusPos=="trailing"){if(this.pagerPos=="center"){var b=a.style(this.pagerContainer,"height"),f=a.style(this.pagerContainerStatus,"height");a.style(this.pagerContainerPager,"top",b/2-f/2+"px")}a.style(this.pagerContainerStatus,"bottom","0px")}else this.pagerPos=="center"&&(b=a.style(this.pagerContainer,"height"),f=a.style(this.pagerContainerStatus,"height"),a.style(this.pagerContainerPager,
"bottom",b/2-f/2+"px")),a.style(this.pagerContainerStatus,"top","0px");b=a.style(this.pagerContainer,"width")/2-this.iconWidth/2;a.style(this.pagerContainerStatus,"paddingLeft",b+"px")}else this.statusPos=="trailing"?(this.pagerPos=="center"&&(b=a.style(this.pagerContainer,"width"),f=a.style(this.pagerContainerStatus,"width"),a.style(this.pagerContainerPager,"left",b/2-f/2+"px")),a.style(this.pagerContainerStatus,"right","0px")):(this.pagerPos=="center"&&(b=a.style(this.pagerContainer,"width"),f=
a.style(this.pagerContainerStatus,"width"),a.style(this.pagerContainerPager,"right",b/2-f/2+"px")),a.style(this.pagerContainerStatus,"left","0px")),b=a.style(this.pagerContainer,"height")/2-this.iconHeight/2,a.style(this.pagerContainerStatus,"paddingTop",b+"px");a.disconnect(this._iconConnects[c])},b));d.src=c==this._currentPage?this.iconPageActive:this.iconPage;b=c;a.addClass(d,this.orientation+"PagerIcon");a.attr(d,"id",this.id+"-status-"+c);this.pagerContainerStatus.appendChild(d);this.orientation==
"vertical"&&a.style(d,"display","block")}},_pagerSkip:function(a){if(this._currentPage!=a){var d;a<this._currentPage?(d=this._currentPage-a,a=this._totalPages+a-this._currentPage):(d=this._totalPages+this._currentPage-a,a-=this._currentPage);var b=a>d;this._toScroll=b?d:a;var e=b?"_pagerPrevious":"_pagerNext",g=this.connect(this,"onScrollEnd",function(){this._toScroll--;if(this._toScroll<1)this.disconnect(g);else this[e]()});this[e]()}},_pagerNext:function(){if(!this._anim){for(var c=[],d=this._currentPage*
this.itemsPage;d>(this._currentPage-1)*this.itemsPage;d--)if(a.byId(this.id+"-item-"+d)){var b=a.byId(this.id+"-item-"+d),e=a.marginBox(b);this.orientation=="horizontal"?(e=e.l-this.itemsPage*e.w,c.push(a.fx.slideTo({node:b,left:e,duration:this.duration}))):(e=e.t-this.itemsPage*e.h,c.push(a.fx.slideTo({node:b,top:e,duration:this.duration})))}var g=this._currentPage;this._currentPage==this._totalPages?this._currentPage=1:this._currentPage++;for(var f=this.itemsPage,d=this._currentPage*this.itemsPage;d>
(this._currentPage-1)*this.itemsPage;d--){if(a.byId(this.id+"-item-"+d))if(b=a.byId(this.id+"-item-"+d),e=a.marginBox(b),this.orientation=="horizontal"){var h=a.style(this.pagerContainerView,"width")+(f-1)*e.w-1;a.style(b,"left",h+"px");a.style(b,"top","0px");e=h-this.itemsPage*e.w;c.push(a.fx.slideTo({node:b,left:e,duration:this.duration}))}else h=a.style(this.pagerContainerView,"height")+(f-1)*e.h-1,a.style(b,"top",h+"px"),a.style(b,"left","0px"),e=h-this.itemsPage*e.h,c.push(a.fx.slideTo({node:b,
top:e,duration:this.duration}));f--}this._anim=a.fx.combine(c);var j=this.connect(this._anim,"onEnd",function(){delete this._anim;this.onScrollEnd();this.disconnect(j)});this._anim.play();a.byId(this.id+"-status-"+g).src=this.iconPage;a.byId(this.id+"-status-"+this._currentPage).src=this.iconPageActive}},_pagerPrevious:function(){if(!this._anim){for(var c=[],d=this._currentPage*this.itemsPage;d>(this._currentPage-1)*this.itemsPage;d--)if(a.byId(this.id+"-item-"+d)){var b=a.byId(this.id+"-item-"+d),
e=a.marginBox(b);if(this.orientation=="horizontal"){var g=a.style(b,"left")+this.itemsPage*e.w;c.push(a.fx.slideTo({node:b,left:g,duration:this.duration}))}else g=a.style(b,"top")+this.itemsPage*e.h,c.push(a.fx.slideTo({node:b,top:g,duration:this.duration}))}var f=this._currentPage;this._currentPage==1?this._currentPage=this._totalPages:this._currentPage--;for(var h=this.itemsPage,j=1,d=this._currentPage*this.itemsPage;d>(this._currentPage-1)*this.itemsPage;d--){if(a.byId(this.id+"-item-"+d))if(b=
a.byId(this.id+"-item-"+d),e=a.marginBox(b),this.orientation=="horizontal"){var i=-(j*e.w)+1;a.style(b,"left",i+"px");a.style(b,"top","0px");g=(h-1)*e.w;c.push(a.fx.slideTo({node:b,left:g,duration:this.duration}));g=i+this.itemsPage*e.w;c.push(a.fx.slideTo({node:b,left:g,duration:this.duration}))}else i=-(j*e.h+1),a.style(b,"top",i+"px"),a.style(b,"left","0px"),g=(h-1)*e.h,c.push(a.fx.slideTo({node:b,top:g,duration:this.duration}));h--;j++}this._anim=a.fx.combine(c);var m=a.connect(this._anim,"onEnd",
a.hitch(this,function(){delete this._anim;this.onScrollEnd();a.disconnect(m)}));this._anim.play();a.byId(this.id+"-status-"+f).src=this.iconPage;a.byId(this.id+"-status-"+this._currentPage).src=this.iconPageActive}},onScrollEnd:function(){}});a.declare("dojox.widget._PagerItem",[i._Widget,i._Templated],{templateString:'<li class="pagerItem" dojoAttachPoint="containerNode"></li>',resizeChildren:function(){var c=a.marginBox(this.containerNode);a.style(this.containerNode.firstChild,{width:c.w+"px",height:c.h+
"px"})},parseChildren:function(){a.parser.parse(this.containerNode)}})});