//>>built
define("dojox/mdnd/dropMode/OverDropMode",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/connect","dojo/_base/html","dojo/_base/array","dojox/mdnd/AreaManager"],function(f){var k=f.declare("dojox.mdnd.dropMode.OverDropMode",null,{_oldXPoint:null,_oldYPoint:null,_oldBehaviour:"up",constructor:function(){this._dragHandler=[f.connect(dojox.mdnd.areaManager(),"onDragEnter",function(){var a=dojox.mdnd.areaManager();if(a._oldIndexArea==-1)a._oldIndexArea=a._lastValidIndexArea})]},addArea:function(a,
c){var b=a.length,e=f.position(c.node,!0);c.coords={x:e.x,y:e.y};if(b==0)a.push(c);else{for(var d=c.coords.x,e=0;e<b;e++)if(d<a[e].coords.x){for(d=b-1;d>=e;d--)a[d+1]=a[d];a[e]=c;break}e==b&&a.push(c)}return a},updateAreas:function(a){for(var c=a.length,b=0;b<c;b++)this._updateArea(a[b])},_updateArea:function(a){var c=f.position(a.node,!0);a.coords.x=c.x;a.coords.x2=c.x+c.w;a.coords.y=c.y},initItems:function(a){f.forEach(a.items,function(a){var b=f.position(a.item.node,!0);a.y=b.y+b.h/2});a.initItems=
!0},refreshItems:function(a,c,b,e){if(c!=-1&&a&&b&&b.h){b=b.h;a.margin&&(b+=a.margin.t);for(var d=a.items.length;c<d;c++){var h=a.items[c];e?h.y+=b:h.y-=b}}},getDragPoint:function(a,c,b){return{x:b.x,y:b.y}},getTargetArea:function(a,c,b){var e=0,d=c.x,h=c.y,f=a.length,g=0,j="right",i=!1;b==-1||arguments.length<3?i=!0:this._checkInterval(a,b,d,h)?e=b:(this._oldXPoint<d?g=b+1:(g=b-1,f=0,j="left"),i=!0);if(i)if(j==="right"){for(;g<f;g++)if(this._checkInterval(a,g,d,h)){e=g;break}g==f&&(e=-1)}else{for(;g>=
f;g--)if(this._checkInterval(a,g,d,h)){e=g;break}g==f-1&&(e=-1)}this._oldXPoint=d;return e},_checkInterval:function(a,c,b,e){var d=a[c],a=d.coords,c=a.x2,f=a.y,d=f+d.node.offsetHeight;if(a.x<=b&&b<=c&&f<=e&&e<=d)return!0;return!1},getDropIndex:function(a,c){var b=a.items.length,e=c.y;if(b>0)for(var d=0;d<b;d++)if(e<a.items[d].y)return d;else if(d==b-1)break;return-1},destroy:function(){f.forEach(this._dragHandler,f.disconnect)}});dojox.mdnd.areaManager()._dropMode=new dojox.mdnd.dropMode.OverDropMode;
return k});