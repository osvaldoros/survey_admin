//>>built
define("dojox/data/util/JsonQuery",["dojo","dojox"],function(h,e){h.declare("dojox.data.util.JsonQuery",null,{useFullIdInQueries:!1,_toJsonQuery:function(a,b){function e(b,f){var d=f.__id;if(d){var c={};c[j.idAttribute]=j.useFullIdInQueries?f.__id:f[j.idAttribute];f=c}for(var k in f){var c=f[k],m=b+(/^[a-zA-Z_][\w_]*$/.test(k)?"."+k:"["+h._escapeString(k)+"]");c&&typeof c=="object"?e(m,c):c!="*"&&(l+=(g?"":"&")+m+(!d&&typeof c=="string"&&a.queryOptions&&a.queryOptions.ignoreCase?"~":"=")+(j.simplifiedQuery?
encodeURIComponent(c):h.toJson(c)),g=!1)}}var g=!0,j=this;if(a.query&&typeof a.query=="object"){var l="[?(";e("@",a.query);g?l="":l+=")]";a.queryStr=l.replace(/\\"|"/g,function(a){return a=='"'?"'":a})}else if(!a.query||a.query=="*")a.query="";var d=a.sort;if(d){a.queryStr=a.queryStr||(typeof a.query=="string"?a.query:"");g=!0;for(i=0;i<d.length;i++)a.queryStr+=(g?"[":",")+(d[i].descending?"\\":"/")+"@["+h._escapeString(d[i].attribute)+"]",g=!1;a.queryStr+="]"}if(b&&(a.start||a.count))a.queryStr=
(a.queryStr||(typeof a.query=="string"?a.query:""))+"["+(a.start||"")+":"+(a.count?(a.start||0)+a.count:"")+"]";if(typeof a.queryStr=="string")return a.queryStr=a.queryStr.replace(/\\"|"/g,function(a){return a=='"'?"'":a}),a.queryStr;return a.query},jsonQueryPagination:!0,fetch:function(a){this._toJsonQuery(a,this.jsonQueryPagination);return this.inherited(arguments)},isUpdateable:function(){return!0},matchesQuery:function(a,b){b._jsonQuery=b._jsonQuery||e.json.query(this._toJsonQuery(b));return b._jsonQuery([a]).length},
clientSideFetch:function(a,b){a._jsonQuery=a._jsonQuery||e.json.query(this._toJsonQuery(a));return this.clientSidePaging(a,a._jsonQuery(b))},querySuperSet:function(a,b){if(!a.query)return b.query;return this.inherited(arguments)}});return e.data.util.JsonQuery});