//>>built
define("dojox/charting/plot2d/Bars",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/declare","./Base","./common","dojox/gfx/fx","dojox/lang/utils","dojox/lang/functional","dojox/lang/functional/reversed"],function(B,j,w,m,n,s,x,k,y,z){var A=z.lambda("item.purgeGroup()");return m("dojox.charting.plot2d.Bars",n,{defaultParams:{hAxis:"x",vAxis:"y",gap:0,animate:null,enableCache:!1},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:""},
constructor:function(a,c){this.opt=j.clone(this.defaultParams);k.updateWithObject(this.opt,c);k.updateWithPattern(this.opt,c,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate},getSeriesStats:function(){var a=s.collectSimpleStats(this.series),c;a.hmin-=0.5;a.hmax+=0.5;c=a.hmin;a.hmin=a.vmin;a.vmin=c;c=a.hmax;a.hmax=a.vmax;a.vmax=c;return a},createRect:function(a,c,f){var e;this.opt.enableCache&&a._rectFreePool.length>0?(e=a._rectFreePool.pop(),
e.setShape(f),c.add(e)):e=c.createRect(f);this.opt.enableCache&&a._rectUsePool.push(e);return e},render:function(a,c){if(this.zoom&&!this.isDataDirty())return this.performZoom(a,c);this.dirty=this.isDirty();this.resetEvents();if(this.dirty){w.forEach(this.series,A);this._eventSeries={};this.cleanGroup();var f=this.group;y.forEachRev(this.series,function(a){a.cleanGroup(f)})}var e=this.chart.theme,h,j,k=this._hScaler.scaler.getTransformerFromModel(this._hScaler),m=this._vScaler.scaler.getTransformerFromModel(this._vScaler),
t=Math.max(0,this._hScaler.bounds.lower),o=k(t),n=this.events();h=s.calculateBarSize(this._vScaler.bounds.scale,this.opt);j=h.gap;h=h.size;for(var p=this.series.length-1;p>=0;--p){var b=this.series[p];if(!this.dirty&&!b.dirty)e.skip(),this._reconnectEvents(b.name);else{b.cleanGroup();if(this.opt.enableCache)b._rectFreePool=(b._rectFreePool?b._rectFreePool:[]).concat(b._rectUsePool?b._rectUsePool:[]),b._rectUsePool=[];for(var u=e.next("bar",[this.opt,b]),f=b.group,v=Array(b.data.length),g=0;g<b.data.length;++g){var d=
b.data[g];if(d!==null){var i=typeof d=="number"?d:d.y,l=k(i),q=Math.abs(l-o),d=typeof d!="number"?e.addMixin(u,"bar",d,!0):e.post(u,"bar");if(q>=0&&h>=1){var l={x:c.l+(i<t?l:o),y:a.height-c.b-m(g+1.5)+j,width:q,height:h},r=this._plotFill(d.series.fill,a,c),r=this._shapeFill(r,l),d=this.createRect(b,f,l).setFill(r).setStroke(d.series.stroke);b.dyn.fill=d.getFill();b.dyn.stroke=d.getStroke();n&&(i={element:"bar",index:g,run:b,shape:d,x:i,y:g+1.5},this._connectEvents(i),v[g]=i);this.animate&&this._animateBar(d,
c.l+o,-q)}}}this._eventSeries[b.name]=v;b.dirty=!1}}this.dirty=!1;return this},_animateBar:function(a,c,f){x.animateTransform(j.delegate({shape:a,duration:1200,transform:[{name:"translate",start:[c-c/f,0],end:[0,0]},{name:"scale",start:[1/f,1],end:[1,1]},{name:"original"}]},this.animate)).play()}})});