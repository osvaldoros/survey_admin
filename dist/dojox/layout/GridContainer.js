//>>built
define("dojox/layout/GridContainer",["dojo/_base/kernel","dojo/_base/array","dojo/_base/connect","dojo/_base/declare","dojo/_base/html","dojo/_base/lang","dojo/_base/window","dojo/ready","dojox/layout/GridContainerLite"],function(c){return c.declare("dojox.layout.GridContainer",dojox.layout.GridContainerLite,{hasResizableColumns:!0,liveResizeColumns:!1,minColWidth:20,minChildWidth:150,mode:"right",isRightFixed:!1,isLeftFixed:!1,startup:function(){this.inherited(arguments);if(this.hasResizableColumns){for(var b=
0;b<this._grid.length-1;b++)this._createGrip(b);this.getParent()||c.ready(c.hitch(this,"_placeGrips"))}},resizeChildAfterDrop:function(){this.inherited(arguments)&&this._placeGrips()},onShow:function(){this.inherited(arguments);this._placeGrips()},resize:function(){this.inherited(arguments);this._isShown()&&this.hasResizableColumns&&this._placeGrips()},_createGrip:function(b){var b=this._grid[b],a=c.create("div",{"class":"gridContainerGrip"},this.domNode);b.grip=a;b.gripHandler=[this.connect(a,"onmouseover",
function(a){for(var b=!1,f=0;f<this._grid.length-1;f++)if(c.hasClass(this._grid[f].grip,"gridContainerGripShow")){b=!0;break}b||(c.removeClass(a.target,"gridContainerGrip"),c.addClass(a.target,"gridContainerGripShow"))})[0],this.connect(a,"onmouseout",function(a){this._isResized||(c.removeClass(a.target,"gridContainerGripShow"),c.addClass(a.target,"gridContainerGrip"))})[0],this.connect(a,"onmousedown","_resizeColumnOn")[0],this.connect(a,"ondblclick","_onGripDbClick")[0]]},_placeGrips:function(){var b,
a,d=0,e;c.forEach(this._grid,function(f){if(f.grip){e=f.grip;b||(b=e.offsetWidth/2);d+=c.marginBox(f.node).w;c.style(e,"left",d-b+"px");if(!a)a=c.contentBox(this.gridNode).h;a>0&&c.style(e,"height",a+"px")}},this)},_onGripDbClick:function(){this._updateColumnsWidth(this._dragManager);this.resize()},_resizeColumnOn:function(b){this._activeGrip=b.target;this._initX=b.pageX;b.preventDefault();c.body().style.cursor="ew-resize";this._isResized=!0;var b=[],a,d;for(d=0;d<this._grid.length;d++)b[d]=c.contentBox(this._grid[d].node).w;
this._oldTabSize=b;for(d=0;d<this._grid.length;d++){a=this._grid[d];if(this._activeGrip==a.grip)this._currentColumn=a.node,this._currentColumnWidth=b[d],this._nextColumn=this._grid[d+1].node,this._nextColumnWidth=b[d+1];a.node.style.width=b[d]+"px"}a=function(a,b){var d=0,h=0;c.forEach(a,function(a){a.nodeType==1&&(a=c.getComputedStyle(a),h=(c.isIE?b:parseInt(a.minWidth))+parseInt(a.marginLeft)+parseInt(a.marginRight),d<h&&(d=h))});return d};b=a(this._currentColumn.childNodes,this.minChildWidth);
a=a(this._nextColumn.childNodes,this.minChildWidth);d=Math.round(c.marginBox(this.gridContainerTable).w*this.minColWidth/100);this._currentMinCol=b;this._nextMinCol=a;if(d>this._currentMinCol)this._currentMinCol=d;if(d>this._nextMinCol)this._nextMinCol=d;this._connectResizeColumnMove=c.connect(c.doc,"onmousemove",this,"_resizeColumnMove");this._connectOnGripMouseUp=c.connect(c.doc,"onmouseup",this,"_onGripMouseUp")},_onGripMouseUp:function(){c.body().style.cursor="default";c.disconnect(this._connectResizeColumnMove);
c.disconnect(this._connectOnGripMouseUp);this._connectOnGripMouseUp=this._connectResizeColumnMove=null;this._activeGrip&&(c.removeClass(this._activeGrip,"gridContainerGripShow"),c.addClass(this._activeGrip,"gridContainerGrip"));this._isResized=!1},_resizeColumnMove:function(b){b.preventDefault();if(!this._connectResizeColumnOff)c.disconnect(this._connectOnGripMouseUp),this._connectOnGripMouseUp=null,this._connectResizeColumnOff=c.connect(c.doc,"onmouseup",this,"_resizeColumnOff");var a=b.pageX-this._initX;
if(a!=0&&!(this._currentColumnWidth+a<this._currentMinCol||this._nextColumnWidth-a<this._nextMinCol))if(this._currentColumnWidth+=a,this._nextColumnWidth-=a,this._initX=b.pageX,this._activeGrip.style.left=parseInt(this._activeGrip.style.left)+a+"px",this.liveResizeColumns)this._currentColumn.style.width=this._currentColumnWidth+"px",this._nextColumn.style.width=this._nextColumnWidth+"px",this.resize()},_resizeColumnOff:function(){c.body().style.cursor="default";c.disconnect(this._connectResizeColumnMove);
c.disconnect(this._connectResizeColumnOff);this._connectResizeColumnOff=this._connectResizeColumnMove=null;if(!this.liveResizeColumns)this._currentColumn.style.width=this._currentColumnWidth+"px",this._nextColumn.style.width=this._nextColumnWidth+"px";var b=[],a=[],d=this.gridContainerTable.clientWidth,e,f=!1,g;for(g=0;g<this._grid.length;g++)e=this._grid[g].node,c.isIE?(b[g]=c.marginBox(e).w,a[g]=c.contentBox(e).w):(b[g]=c.contentBox(e).w,a=b);for(g=0;g<a.length;g++)if(a[g]!=this._oldTabSize[g]){f=
!0;break}if(f){a=c.isIE?100:1E4;for(g=0;g<this._grid.length;g++)this._grid[g].node.style.width=Math.round(100*a*b[g]/d)/a+"%";this.resize()}this._activeGrip&&(c.removeClass(this._activeGrip,"gridContainerGripShow"),c.addClass(this._activeGrip,"gridContainerGrip"));this._isResized=!1},setColumns:function(b){var a,d;if(b>0){a=this._grid.length;b=a-b;if(b>0){var e=[],f,g,h;if(this.mode=="right"){g=this.isLeftFixed&&a>0?1:0;for(a=d=this.isRightFixed?a-2:a-1;a>=g;a--){h=0;f=this._grid[a].node;for(d=0;d<
f.childNodes.length;d++)if(f.childNodes[d].nodeType==1&&f.childNodes[d].id!=""){h++;break}h==0&&(e[e.length]=a);if(e.length>=b){this._deleteColumn(e);break}}}else{d=this.isLeftFixed&&a>0?1:0;g=this.isRightFixed?a-1:a;for(a=d;a<g;a++){h=0;f=this._grid[a].node;for(d=0;d<f.childNodes.length;d++)if(f.childNodes[d].nodeType==1&&f.childNodes[d].id!=""){h++;break}h==0&&(e[e.length]=a);if(e.length>=b){this._deleteColumn(e);break}}}e.length<b&&c.publish("/dojox/layout/gridContainer/noEmptyColumn",[this])}else b<
0&&this._addColumn(Math.abs(b));this.hasResizableColumns&&this._placeGrips()}},_addColumn:function(b){var a=this._grid,d,e,f=this.mode=="right",g=this.acceptTypes.join(","),h=this._dragManager;this.hasResizableColumns&&(!this.isRightFixed&&f||this.isLeftFixed&&!f&&this.nbZones==1)&&this._createGrip(a.length-1);for(var i=0;i<b;i++)d=c.create("td",{"class":"gridContainerZone dojoxDndArea",accept:g,id:this.id+"_dz"+this.nbZones}),e=a.length,f?this.isRightFixed?(e-=1,a.splice(e,0,{node:a[e].node.parentNode.insertBefore(d,
a[e].node)})):a.push({node:this.gridNode.appendChild(d)}):this.isLeftFixed?(e=e==1?0:1,this._grid.splice(1,0,{node:this._grid[e].node.parentNode.appendChild(d,this._grid[e].node)}),e=1):(e-=this.nbZones,this._grid.splice(e,0,{node:a[e].node.parentNode.insertBefore(d,a[e].node)})),this.hasResizableColumns&&(!f&&this.nbZones!=1||!f&&this.nbZones==1&&!this.isLeftFixed||f&&i<b-1||f&&i==b-1&&this.isRightFixed)&&this._createGrip(e),h.registerByNode(a[e].node),this.nbZones++;this._updateColumnsWidth(h)},
_deleteColumn:function(b){for(var a,d,e=0,f=b.length,g=this._dragManager,h=0;h<f;h++){d=this.mode=="right"?b[h]:b[h]-e;a=this._grid[d];if(this.hasResizableColumns&&a.grip)c.forEach(a.gripHandler,function(a){c.disconnect(a)}),c.destroy(this.domNode.removeChild(a.grip)),a.grip=null;g.unregister(a.node);c.destroy(this.gridNode.removeChild(a.node));this._grid.splice(d,1);this.nbZones--;e++}b=this._grid[this.nbZones-1];if(b.grip)c.forEach(b.gripHandler,c.disconnect),c.destroy(this.domNode.removeChild(b.grip)),
b.grip=null;this._updateColumnsWidth(g)},_updateColumnsWidth:function(b){this.inherited(arguments);b._dropMode.updateAreas(b._areaList)},destroy:function(){c.unsubscribe(this._dropHandler);this.inherited(arguments)}})});