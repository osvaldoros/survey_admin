//>>built
define("dojox/mobile/IconItem",["dojo/_base/kernel","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dijit/registry","./common","./_ItemBase","./TransitionEvent"],function(g,j,l,h,m,n,o,e,p,f,q,i,r,k){return l("dojox.mobile.IconItem",r,{lazy:!1,requires:"",timeout:10,closeBtnClass:"mblDomButtonBlueMinus",closeBtnProp:null,templateString:'<div class="mblIconArea" dojoAttachPoint="iconDivNode"><div><img src="${icon}" dojoAttachPoint="iconNode"></div><span dojoAttachPoint="labelNode1"></span></div>',
templateStringSub:'<li class="mblIconItemSub" lazy="${lazy}" style="display:none;" dojoAttachPoint="contentNode"><h2 class="mblIconContentHeading" dojoAttachPoint="closeNode"><div class="${closeBtnClass}" style="position:absolute;left:4px;top:2px;" dojoAttachPoint="closeIconNode"></div><span dojoAttachPoint="labelNode2"></span></h2><div class="mblContent" dojoAttachPoint="containerNode"></div></li>',createTemplate:function(a){j.forEach(["lazy","icon","closeBtnClass"],function(b){for(;a.indexOf("${"+
b+"}")!=-1;)a=a.replace("${"+b+"}",this[b])},this);var b=n.doc.createElement("DIV");b.innerHTML=a;var d=b.getElementsByTagName("*"),c,e,f;e=d.length;for(c=0;c<e;c++)(f=d[c].getAttribute("dojoAttachPoint"))&&(this[f]=d[c]);this.closeIconNode&&this.closeBtnProp&&o.set(this.closeIconNode,this.closeBtnProp);d=b.removeChild(b.firstChild);b=null;return d},buildRendering:function(){this.inheritParams();var a=this.createTemplate(this.templateString);this.subNode=this.createTemplate(this.templateStringSub);
this.subNode._parentNode=this.domNode;this.domNode=this.srcNodeRef||p.create("LI");e.add(this.domNode,"mblIconItem");if(this.srcNodeRef)for(var b=0,d=this.srcNodeRef.childNodes.length;b<d;b++)this.containerNode.appendChild(this.srcNodeRef.firstChild);this.domNode.appendChild(a)},postCreate:function(){i.createDomButton(this.closeIconNode,{top:"-2px",left:"1px"});this.connect(this.iconNode,"onmousedown","onMouseDownIcon");this.connect(this.iconNode,"onclick","iconClicked");this.connect(this.closeIconNode,
"onclick","closeIconClicked");this.connect(this.iconNode,"onerror","onError")},highlight:function(){e.add(this.iconDivNode,"mblVibrate");if(this.timeout>0){var a=this;setTimeout(function(){a.unhighlight()},this.timeout*1E3)}},unhighlight:function(){e.remove(this.iconDivNode,"mblVibrate")},instantiateWidget:function(){for(var a=this.containerNode.getElementsByTagName("*"),b=a.length,d,c=0;c<b;c++)(d=a[c].getAttribute("dojoType"))&&g.require(d);b>0&&g.parser.parse(this.containerNode);this.lazy=!1},
isOpen:function(){return this.containerNode.style.display!="none"},onMouseDownIcon:function(){f.set(this.iconNode,"opacity",this.getParent().pressedIconOpacity)},iconClicked:function(a){if(a)this.setTransitionPos(a),setTimeout(h.hitch(this,function(){this.iconClicked()}),0);else if(this.href&&this.hrefTarget)i.openWindow(this.href,this.hrefTarget),g.style(this.iconNode,"opacity",1);else{var b;if(this.moveTo||this.href||this.url||this.scene)b={moveTo:this.moveTo,href:this.href,url:this.url,scene:this.scene,
transitionDir:this.transitionDir,transition:this.transition};else if(this.transitionOptions)b=this.transitionOptions;if(b)setTimeout(h.hitch(this,function(){f.set(this.iconNode,"opacity",1)}),1500);else return this.open(a);if(b)return(new k(this.domNode,b,a)).dispatch()}},closeIconClicked:function(a){a?setTimeout(h.hitch(this,function(){this.closeIconClicked()}),0):this.close()},open:function(a){var b=this.getParent();if(this.transition=="below")b.single&&(b.closeAll(),f.set(this.iconNode,"opacity",
this.getParent().pressedIconOpacity)),this._open_1();else{b._opening=this;if(b.single)this.closeNode.style.display="none",b.closeAll(),q.byId(b.id+"_mblApplView")._heading._setLabelAttr(this.label);(new k(this.domNode,this.transitionOptions||{transition:this.transition,transitionDir:this.transitionDir,moveTo:b.id+"_mblApplView"},a)).dispatch()}},_open_1:function(){this.contentNode.style.display="";this.unhighlight();this.lazy&&(this.requires&&j.forEach(this.requires.split(/,/),function(a){g.require(a)}),
this.instantiateWidget());this.contentNode.scrollIntoView();this.onOpen()},close:function(){if(m("webkit")){for(var a=this.domNode.parentNode.offsetWidth/8,b=this.iconNode.offsetLeft,d=0,c=1;c<=3;c++)if(a*(2*c-1)<b&&b<=a*(2*(c+1)-1)){d=c;break}e.add(this.containerNode.parentNode,"mblCloseContent mblShrink"+d)}else this.containerNode.parentNode.style.display="none";f.set(this.iconNode,"opacity",1);this.onClose()},onOpen:function(){},onClose:function(){},onError:function(){var a=this.getParent().defaultIcon;
if(a)this.iconNode.src=a},_setIconAttr:function(a){if(this.getParent()&&(this.icon=a,i.createIcon(a,this.iconPos,this.iconNode,this.alt),this.iconPos)){e.add(this.iconNode,"mblIconItemSpriteIcon");var a=this.iconPos.split(/[ ,]/),b=this.iconNode.parentNode;f.set(b,{width:a[2]+"px",top:Math.round((b.offsetHeight-a[3])/2)+1+"px",margin:"auto"})}},_setLabelAttr:function(a){this.label=a;a=this._cv?this._cv(a):a;this.labelNode1.innerHTML=a;this.labelNode2.innerHTML=a}})});