//>>built
define("dojox/av/widget/VolumeButton",["dojo","dijit","dijit/_Widget","dijit/_TemplatedMixin","dijit/form/Button"],function(a,e){a.declare("dojox.av.widget.VolumeButton",[e._Widget,e._TemplatedMixin],{templateString:a.cache("dojox.av.widget","resources/VolumeButton.html"),postCreate:function(){this.handleWidth=a.marginBox(this.handle).w;this.width=a.marginBox(this.volumeSlider).w;this.slotWidth=100;a.setSelectable(this.handle,!1);this.volumeSlider=this.domNode.removeChild(this.volumeSlider)},setMedia:function(a){this.media=
a;this.updateIcon()},updateIcon:function(b){b=b===void 0?this.media.volume():b;b===0?a.attr(this.domNode,"class","Volume mute"):b<0.334?a.attr(this.domNode,"class","Volume low"):b<0.667?a.attr(this.domNode,"class","Volume med"):a.attr(this.domNode,"class","Volume high")},onShowVolume:function(){if(this.showing==void 0)a.body().appendChild(this.volumeSlider),this.showing=!1;if(this.showing)this.onHideVolume();else{var b=this.media.volume(),c=this._getVolumeDim(),d=this._getHandleDim();this.x=c.x-this.width;
a.style(this.volumeSlider,"display","");a.style(this.volumeSlider,"top",c.y+"px");a.style(this.volumeSlider,"left",this.x+"px");b*=this.slotWidth;a.style(this.handle,"top",2+d.w/2+"px");a.style(this.handle,"left",b+7+d.h/2+"px");this.showing=!0;this.clickOff=a.connect(a.doc,"onmousedown",this,"onDocClick")}},onDocClick:function(b){if(!a.isDescendant(b.target,this.domNode)&&!a.isDescendant(b.target,this.volumeSlider))this.onHideVolume()},onHideVolume:function(){this.endDrag();a.style(this.volumeSlider,
"display","none");this.showing=!1},onDrag:function(b){var c=this.handleWidth/2,d=c+this.slotWidth,b=b.clientX-this.x;b<c&&(b=c);b>d&&(b=d);a.style(this.handle,"left",b+"px");c=(b-c)/(d-c);this.media.volume(c);this.updateIcon(c)},startDrag:function(){this.isDragging=!0;this.cmove=a.connect(a.doc,"mousemove",this,"onDrag");this.cup=a.connect(a.doc,"mouseup",this,"endDrag")},endDrag:function(){this.isDragging=!1;this.cmove&&a.disconnect(this.cmove);this.cup&&a.disconnect(this.cup);this.handleOut()},
handleOver:function(){a.addClass(this.handle,"over")},handleOut:function(){this.isDragging||a.removeClass(this.handle,"over")},_getVolumeDim:function(){if(this._domCoords)return this._domCoords;return this._domCoords=a.coords(this.domNode)},_getHandleDim:function(){if(this._handleCoords)return this._handleCoords;return this._handleCoords=a.marginBox(this.handle)},onResize:function(){this.onHideVolume();this._domCoords=null}});return dojox.av.widget.VolumeButton});